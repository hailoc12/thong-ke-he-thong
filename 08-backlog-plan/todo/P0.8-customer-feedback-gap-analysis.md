# P0.8 Customer Feedback Gap Analysis

**Date:** 2026-01-19
**Status:** Gap Analysis Complete
**Complexity:** HIGH - Major form redesign required
**Estimated Total Effort:** 3-4 weeks (Full-stack + Backend migration)

---

## Executive Summary

### Overall Gap Status

| Category | Count | Status |
|----------|-------|--------|
| ‚úÖ Fully Implemented | 15 fields | 24% |
| üîÑ Partially Implemented | 18 fields | 29% |
| ‚ùå Missing | 27 fields | 44% |
| ‚ö†Ô∏è Incorrect - Needs Removal | 6 fields | 10% |
| **Total Changes Required** | **51 changes** | **100%** |

### Critical Findings

1. **Major Gap:** 27 fields (44%) are completely missing from implementation
2. **Schema Mismatch:** Current backend uses flat structure, customer wants structured sections
3. **Field Inconsistency:** Several fields exist but don't match customer requirements
4. **UI/UX:** Current form has 8 tabs but content doesn't match customer feedback sections

---

## Section-by-Section Analysis

### SECTION 1: Th√¥ng tin c∆° b·∫£n (Basic Information)

#### ‚úÖ ALREADY IMPLEMENTED (7 fields)

| Field | Backend | Frontend | Status |
|-------|---------|----------|--------|
| system_name (T√™n H·ªá th·ªëng) | ‚úÖ System.system_name | ‚úÖ Line 187-193 | ‚úÖ PASS |
| system_name_en (T√™n ti·∫øng Anh) | ‚úÖ System.system_name_en | ‚úÖ Line 195-199 | ‚úÖ PASS |
| description (M√¥ t·∫£) | ‚úÖ System.purpose | ‚úÖ Line 207-215 | ‚úÖ PASS |
| status (Tr·∫°ng th√°i) | ‚úÖ System.status | ‚úÖ Line 217-232 | ‚úÖ PASS |
| criticality_level (M·ª©c ƒë·ªô quan tr·ªçng) | ‚úÖ System.criticality_level | ‚úÖ Line 235-249 (3 levels) | ‚úÖ PASS |
| system_code (M√£ H·ªá th·ªëng) | ‚úÖ Auto-generated (Line 295-318) | ‚úÖ Read-only display (Line 202-205) | ‚úÖ PASS |
| go_live_date (Ng√†y v·∫≠n h√†nh) | ‚úÖ System.go_live_date | ‚ùå MISSING from form | ‚ö†Ô∏è PARTIAL |

#### ‚ùå MISSING FIELDS (3 fields)

| Field | Customer Requirement | Backend Status | Frontend Status | Priority |
|-------|---------------------|----------------|-----------------|----------|
| **Ph·∫°m vi** (Scope) | Make REQUIRED | ‚úÖ System.scope (line 53-58) but blank=True | ‚ùå NOT in form | **P0** |
| **Nh√≥m h·ªá th·ªëng** (System Group) | Make REQUIRED + 8 specific options | ‚ö†Ô∏è System.system_group (line 236-240) only 7 options | ‚ùå NOT in form | **P0** |
| **Ng√†y v·∫≠n h√†nh** (Go Live Date) | Month/Year ONLY (remove Day) | ‚ö†Ô∏è System.go_live_date is DateField (includes day) | ‚ùå NOT in form | **P1** |

**Gap Analysis for Scope:**
- Backend: Has `scope` field but `blank=True` (not required)
- Customer: Make it REQUIRED
- Action: Add `blank=False, null=False` to model + add to form

**Gap Analysis for System Group:**
- Backend: Only 7 options (platform, business, portal, website, bi, esb, other)
- Customer: 8 options with different names
- Customer options:
  1. "N·ªÅn t·∫£ng qu·ªëc gia" (NEW)
  2. "N·ªÅn t·∫£ng d√πng chung c·ªßa B·ªô" (RENAME from "platform")
  3. "CSDL chuy√™n ng√†nh" (NEW)
  4. "·ª®ng d·ª•ng nghi·ªáp v·ª•" (RENAME from "business")
  5. "C·ªïng th√¥ng tin" (RENAME from "portal")
  6. "BI/B√°o c√°o" (RENAME from "bi")
  7. "ESB/T√≠ch h·ª£p" (RENAME from "esb")
  8. "Kh√°c" (KEEP as "other")
- Action: Update GROUP_CHOICES in model (line 14-22)

**Gap Analysis for Go Live Date:**
- Backend: DateField (includes day)
- Customer: Month/Year only
- Action: Change to separate month/year fields OR use custom widget

#### üîÑ PARTIALLY IMPLEMENTED (3 fields)

| Field | Current Implementation | Customer Requirement | Gap | Priority |
|-------|----------------------|---------------------|-----|----------|
| **S·ªë l·∫ßn n√¢ng c·∫•p** | ‚ùå NOT in backend | ‚ûï Add new field | Missing from models.py | **P1** |
| **Th·ªùi gian n√¢ng c·∫•p g·∫ßn nh·∫•t** | ‚ö†Ô∏è System.upgrade_history (JSON) | ‚ûï Add specific date field | upgrade_history is array, need single date | **P1** |
| **description** | ‚úÖ System.purpose | üìù Keep but validate | Purpose field exists, just needs validation | **P2** |

---

### SECTION 2: M·ª•c ti√™u ‚Äì ph·∫°m vi ‚Äì ng∆∞·ªùi d√πng (NEW SECTION - Customer Feedback)

This section is **COMPLETELY NEW** according to customer feedback.

#### ‚úÖ ALREADY IMPLEMENTED (5 fields - Good job on P0.8!)

| Field | Backend | Frontend | Status |
|-------|---------|----------|--------|
| business_objectives (M·ª•c ti√™u nghi·ªáp v·ª•) | ‚úÖ System.business_objectives (line 68-72) | ‚úÖ Line 265-272 with validation max 5 | ‚úÖ PASS |
| business_processes (Quy tr√¨nh nghi·ªáp v·ª•) | ‚úÖ System.business_processes (line 73-76) | ‚úÖ Line 275-282 | ‚úÖ PASS |
| has_design_documents (H·ªì s∆° ph√¢n t√≠ch thi·∫øt k·∫ø) | ‚úÖ System.has_design_documents (line 78-82) | ‚úÖ Line 285-293 with Switch | ‚úÖ PASS |
| user_types (ƒê·ªëi t∆∞·ª£ng s·ª≠ d·ª•ng) | ‚úÖ System.user_types (line 83-87) | ‚úÖ Line 296-327 Checkbox.Group | ‚úÖ PASS |
| annual_users (S·ªë l∆∞·ª£ng ng∆∞·ªùi d√πng) | ‚ö†Ô∏è System.annual_users (line 88-93) | ‚ö†Ô∏è Line 330-338 | ‚úÖ PASS |

#### ‚ùå MISSING FIELDS (4 fields - Critical!)

| Field | Customer Requirement | Backend Status | Frontend Status | Priority |
|-------|---------------------|----------------|-----------------|----------|
| **T·ªïng s·ªë t√†i kho·∫£n** | Add numeric field | ‚ùå NOT in models | ‚ùå NOT in form | **P0** |
| **MAU** | Monthly Active Users | ‚ö†Ô∏è System.users_mau exists (line 261) | ‚ùå NOT in form | **P0** |
| **DAU** | Daily Active Users | ‚ö†Ô∏è System.users_dau exists (line 262) | ‚ùå NOT in form | **P0** |
| **S·ªë ƒë∆°n v·ªã/ƒë·ªãa ph∆∞∆°ng** | Optional field | ‚ö†Ô∏è System.num_organizations exists (line 263) | ‚ùå NOT in form | **P1** |

**Critical Finding:** These fields EXIST in backend models (line 260-263) but are NOT displayed in the form! This is a **P0 blocker**.

---

### SECTION 3: Ki·∫øn tr√∫c ·ª©ng d·ª•ng (Application Architecture)

#### üîÑ PARTIALLY IMPLEMENTED (5 fields)

| Field | Customer Requirement | Current Implementation | Gap | Priority |
|-------|---------------------|----------------------|-----|----------|
| **Lo·∫°i ki·∫øn tr√∫c** | Add Serverless, SaaS | SystemArchitecture.ARCHITECTURE_TYPE_CHOICES (line 327-332) | Missing: serverless, saas | **P1** |
| **C√≥ ph√¢n l·ªõp kh√¥ng?** | Presentation/Business/Data/Integration | ‚ùå NOT in backend | ‚ùå NOT in form | **P1** |
| **Multi-tenant** | Yes/No field | ‚ùå NOT in backend | ‚ùå NOT in form | **P1** |
| **Container h√≥a** | Docker/K8s/OpenShift/Kh√°c | ‚ùå NOT in backend | ‚ùå NOT in form | **P1** |
| **Frontend tech stack** | Framework + version | ‚ö†Ô∏è SystemArchitecture.frontend_tech (line 369) | ‚ùå NOT in form | **P1** |

#### ‚ùå MISSING FIELDS (12 fields)

| Field | Customer Requirement | Backend Status | Frontend Status | Priority |
|-------|---------------------|----------------|-----------------|----------|
| **Backend tech stack** | Language + framework + version | ‚ö†Ô∏è SystemArchitecture.backend_tech (line 368) | ‚ùå NOT in form | **P1** |
| **API style** | REST/GraphQL/gRPC/SOAP/Kh√°c | ‚ùå NOT in backend | ‚ùå NOT in form | **P1** |
| **Messaging/Queue** | Kafka/RabbitMQ/ActiveMQ/None | ‚ùå NOT in backend | ‚ùå NOT in form | **P2** |
| **Cache** | Redis/Memcached/None | ‚ùå NOT in backend | ‚ùå NOT in form | **P2** |
| **Search** | Elasticsearch/Solr/None | ‚ùå NOT in backend | ‚ùå NOT in form | **P2** |
| **Reporting/BI** | PowerBI/Tableau/Metabase/Superset/Custom/None | ‚ùå NOT in backend | ‚ùå NOT in form | **P2** |
| **Authentication methods** | LDAP/AD/SSO/OIDC/SAML/Local | ‚ö†Ô∏è System.authentication_method exists (line 176-189) | ‚úÖ Line 472-482 | ‚úÖ PASS |
| **M√£ ngu·ªìn repository** | GitLab/GitHub/Bitbucket/On-prem/Kh√¥ng qu·∫£n l√Ω | ‚ùå NOT in backend | ‚ùå NOT in form | **P1** |
| **CI/CD** | Yes/No + tool name | ‚ùå NOT in backend | ‚ùå NOT in form | **P1** |
| **T·ª± ƒë·ªông h√≥a ki·ªÉm th·ª≠** | Yes/No + tool name | ‚ùå NOT in backend | ‚ùå NOT in form | **P2** |
| **Nh√°nh release/branching model** | Text field | ‚ùå NOT in backend | ‚ùå NOT in form | **P2** |

**Critical Finding:** Current "Ki·∫øn tr√∫c c√¥ng ngh·ªá" tab (Tab 3, line 344-383) only has 4 generic fields (programming_language, framework, database_name, hosting_platform). Customer wants **detailed** architecture fields.

---

### SECTION 4: CSDL & M√¥ h√¨nh d·ªØ li·ªáu (Data Architecture)

#### ‚ùå MISSING FIELDS (15 fields - Entire section needs overhaul)

| Field | Customer Requirement | Current Implementation | Gap | Priority |
|-------|---------------------|----------------------|-----|----------|
| **DB ch√≠nh** | Oracle/SQL Server/PostgreSQL/MySQL/NoSQL + version | ‚ö†Ô∏è System.database_name (line 110-115) | Only single field, no version | **P1** |
| **DB ph·ª•/kh√°c** | List additional databases | ‚ùå NOT in backend | ‚ùå NOT in form | **P1** |
| **L∆∞u file** | File server/Object Storage/DB BLOB/ECM/DMS | ‚ùå NOT in backend | ‚ùå NOT in form | **P1** |
| **Dung l∆∞·ª£ng DB hi·ªán t·∫°i** | Required number (GB/TB) | ‚ö†Ô∏è SystemDataInfo.storage_size_gb (line 418-424) | ‚ùå NOT in form | **P0** |
| **Dung l∆∞·ª£ng file ƒë√≠nh k√®m** | Required number (GB/TB) | ‚ùå NOT in backend | ‚ùå NOT in form | **P0** |
| **T·ªëc ƒë·ªô tƒÉng tr∆∞·ªüng** | GB/th√°ng ho·∫∑c %/nƒÉm | ‚ö†Ô∏è SystemDataInfo.growth_rate_percent (line 425-431) | ‚ùå NOT in form | **P0** |
| **S·ªë b·∫£n ghi (∆∞·ªõc l∆∞·ª£ng)** | Numeric field | ‚ùå NOT in backend | ‚ùå NOT in form | **P1** |
| **Retention (l∆∞u bao l√¢u)** | Text field | ‚ùå NOT in backend | ‚ùå NOT in form | **P1** |
| **C√≥ ERD kh√¥ng?** | Yes/No with attachment | ‚ö†Ô∏è SystemArchitecture.has_data_model_doc (line 385-388) | ‚ùå NOT in form | **P1** |
| **Danh m·ª•c d√πng chung** | Text/list field | ‚ùå NOT in backend | ‚ùå NOT in form | **P2** |
| **D·ªØ li·ªáu master** | What data is this system source of | ‚ùå NOT in backend | ‚ùå NOT in form | **P2** |
| **D·ªØ li·ªáu nh·∫°y c·∫£m/PII** | Yes/No + type | ‚ö†Ô∏è SystemDataInfo.has_personal_data (line 447-448) | ‚ùå NOT in form | **P1** |
| **Ngu·ªìn d·ªØ li·ªáu** | ‚úÖ | ‚úÖ System.data_sources (line 130-134) | ‚úÖ Line 396-399 | ‚úÖ PASS |
| **Ph√¢n lo·∫°i d·ªØ li·ªáu** | ‚úÖ | ‚úÖ System.data_classification_type (line 135-140) | ‚úÖ Line 402-405 | ‚úÖ PASS |
| **Kh·ªëi l∆∞·ª£ng d·ªØ li·ªáu** | ‚úÖ | ‚úÖ System.data_volume (line 141-146) | ‚úÖ Line 408-411 | ‚úÖ PASS |

**Finding:** Current "Ki·∫øn tr√∫c d·ªØ li·ªáu" tab (Tab 4, line 386-415) only has 3 basic fields. Customer wants **comprehensive** data architecture section with 15 fields.

---

### SECTION 5: T√≠ch h·ª£p ‚Äì li√™n th√¥ng (Integration)

#### ‚ùå MISSING FIELDS (11 fields - Major expansion needed)

| Field | Customer Requirement | Current Implementation | Gap | Priority |
|-------|---------------------|----------------------|-----|----------|
| **Danh s√°ch t√≠ch h·ª£p chi ti·∫øt** | For each connection: h·ªá th·ªëng A‚ÜîB, d·ªØ li·ªáu, c√°ch, t·∫ßn su·∫•t, retry | ‚ùå NOT in backend | ‚ùå NOT in form | **P0** |
| **API Inventory** | Total APIs provided/consumed | ‚ùå NOT in backend | ‚ùå NOT in form | **P0** |
| **C√≥ API gateway kh√¥ng?** | Yes/No | ‚ùå NOT in backend | ‚ùå NOT in form | **P1** |
| **Chu·∫©n versioning, throttling, logging** | Text/checklist | ‚ùå NOT in backend | ‚ùå NOT in form | **P2** |
| **C√≥ API doc kh√¥ng?** | Yes/No | ‚ùå NOT in backend | ‚ùå NOT in form | **P1** |
| **H·ªá th·ªëng n·ªôi b·ªô t√≠ch h·ª£p** | ‚úÖ | ‚úÖ System.integrated_internal_systems (line 151-155) | ‚úÖ Line 427-433 | ‚úÖ PASS |
| **H·ªá th·ªëng b√™n ngo√†i t√≠ch h·ª£p** | ‚úÖ | ‚úÖ System.integrated_external_systems (line 156-160) | ‚úÖ Line 437-443 | ‚úÖ PASS |
| **API/Webservices** | ‚úÖ | ‚úÖ System.api_list (line 161-165) | ‚úÖ Line 447-450 | ‚úÖ PASS |
| **Ph∆∞∆°ng th·ª©c trao ƒë·ªïi d·ªØ li·ªáu** | ‚úÖ | ‚úÖ System.data_exchange_method (line 166-171) | ‚úÖ Line 453-456 | ‚úÖ PASS |

**Critical Finding:** Current integration tab (Tab 5, line 416-460) only has basic lists. Customer wants **detailed integration matrix** with multiple fields per connection.

**Complexity:** This requires dynamic form (add/remove multiple integration connections).

---

### SECTION 6: V·∫≠n h√†nh (Operations)

#### ‚ùå MISSING FIELDS (2 fields)

| Field | Customer Requirement | Current Implementation | Gap | Priority |
|-------|---------------------|----------------------|-----|----------|
| **N∆°i ƒë·∫∑t** | DC B·ªô/Thu√™ ngo√†i/Cloud (AWS/Azure/GCP/VC)/Hybrid | ‚ùå NOT in backend | ‚ùå NOT in form | **P1** |
| **Compute** | S·ªë VM/c·∫•u h√¨nh CPU/RAM/OS | ‚ö†Ô∏è SystemInfrastructure.server_specs (line 815) exists | ‚ùå NOT in form | **P1** |

#### ‚ö†Ô∏è FIELDS TO REMOVE (2 fields - Per customer request)

| Field | Customer Request | Current Implementation | Action Required |
|-------|-----------------|----------------------|-----------------|
| **business_owner** (Ch·ªß s·ªü h·ªØu nghi·ªáp v·ª•) | ‚ùå REMOVE | ‚úÖ System.business_owner (line 253) + Form Line 564-566 | Remove from model + form |
| **technical_owner** (Ch·ªß s·ªü h·ªØu k·ªπ thu·∫≠t) | ‚ùå REMOVE | ‚úÖ System.technical_owner (line 254) + Form Line 570-572 | Remove from model + form |

**Note:** Customer specifically said to remove "Ch·ªß s·ªü h·ªØu nghi·ªáp v·ª• / Ch·ªß s·ªü h·ªØu k·ªπ thu·∫≠t" from Section 1. However, current implementation still has these in Tab 8 "V·∫≠n h√†nh" (line 564-572).

---

### SECTION 7: ATTT ‚Äì an to√†n h·ªá th·ªëng (Security)

#### ‚ùå MISSING FIELDS (2 fields - Critical!)

| Field | Customer Requirement | Current Implementation | Gap | Priority |
|-------|---------------------|----------------------|-----|----------|
| **Ph√¢n lo·∫°i h·ªá th·ªëng theo c·∫•p ƒë·ªô** | C·∫•p 1-5 (per regulation) | ‚ùå NOT in backend | ‚ùå NOT in form | **P0** |
| **H·ªì s∆° ATTT** | C√≥/Kh√¥ng | ‚ùå NOT in backend | ‚ùå NOT in form | **P0** |

#### ‚úÖ ALREADY IMPLEMENTED (4 fields)

| Field | Backend | Frontend | Status |
|-------|---------|----------|--------|
| authentication_method | ‚úÖ System.authentication_method (line 176-189) | ‚úÖ Line 472-482 | ‚úÖ PASS |
| has_encryption | ‚úÖ System.has_encryption (line 190-194) | ‚úÖ Line 486-494 | ‚úÖ PASS |
| has_audit_log | ‚úÖ System.has_audit_log (line 195-199) | ‚úÖ Line 497-505 | ‚úÖ PASS |
| compliance_standards_list | ‚úÖ System.compliance_standards_list (line 200-205) | ‚úÖ Line 508-511 | ‚úÖ PASS |

---

### SECTION 8: ƒê√°nh gi√° m·ª©c n·ª£ k·ªπ thu·∫≠t (Technical Debt Assessment)

#### ‚ùå MISSING ENTIRE SECTION (3 fields - NEW section!)

This section is **COMPLETELY NEW** per customer feedback. Current implementation has `SystemAssessment` model (line 593-663) but it doesn't match customer requirements.

| Field | Customer Requirement | Current Implementation | Gap | Priority |
|-------|---------------------|----------------------|-----|----------|
| **ƒêi·ªÉm ph√π h·ª£p** (Integration readiness) | Checkboxes: D·ªÖ chu·∫©n h√≥a, C√≥ API t·ªët, D·ªØ li·ªáu r√µ ngu·ªìn g·ªëc, C√≥ th·ªÉ t√°ch d·ªãch v·ª• | ‚ùå NOT in backend | ‚ùå NOT in form | **P1** |
| **ƒêi·ªÉm v∆∞·ªõng** (Blockers) | Checkboxes: C√¥ng ngh·ªá qu√° c≈©, Kh√¥ng c√≥ t√†i li·ªáu, Kh√¥ng c√≥ API, D·ªØ li·ªáu kh√¥ng s·∫°ch, Ph·ª• thu·ªôc nh√† th·∫ßu | ‚ùå NOT in backend | ‚ùå NOT in form | **P1** |
| **ƒê·ªÅ xu·∫•t c·ªßa ƒë∆°n v·ªã** | Select: Gi·ªØ nguy√™n/N√¢ng c·∫•p/Thay th·∫ø/H·ª£p nh·∫•t | ‚ö†Ô∏è SystemAssessment.needs_replacement (line 641) | ‚ùå NOT in form | **P1** |

---

## Fields to REMOVE (Per Customer Request)

### ‚ùå REMOVE from Backend Models + Frontend Form

| # | Field Name | Customer Reason | Backend Location | Frontend Location | Priority |
|---|-----------|-----------------|------------------|-------------------|----------|
| 1 | **org** (Ch·ªçn ƒê∆°n v·ªã) | Auto-fill by backend | System.org (line 39-44) | Line 163-183 (admin only) | **P0** |
| 2 | **system_code** (M√£ H·ªá th·ªëng) | Auto-generate (already done) | Already auto-gen (line 295-318) | Read-only display (line 202-205) | ‚úÖ OK |
| 3 | **purpose** (M·ª•c ƒë√≠ch / M√¥ t·∫£) | Move to different section | System.purpose (line 52) | Line 207-215 | ‚ö†Ô∏è **P1** |
| 4 | **form_level** (C·∫•p ƒë·ªô form) | Remove this field | System.form_level (line 274-278) | ‚ùå NOT in form | **P2** |
| 5 | **business_owner** (Ch·ªß s·ªü h·ªØu nghi·ªáp v·ª•) | Remove | System.business_owner (line 253) | Line 564-566 | **P1** |
| 6 | **technical_owner** (Ch·ªß s·ªü h·ªØu k·ªπ thu·∫≠t) | Remove | System.technical_owner (line 254) | Line 570-572 | **P1** |

**Clarification on Field Removal:**

1. **org** - Customer said "b·ªè" but backend needs this for data integrity. For org users, auto-fill. For admin, keep but make read-only or auto-select from context.
2. **system_code** - Already auto-generating correctly. No action needed.
3. **purpose** - Customer said "b·ªè ph·∫ßn n√†y ƒë∆∞a v√†o d∆∞·ªõi" but it's unclear where "d∆∞·ªõi" is. Likely keep but rename/move.
4. **form_level** - Customer wants to remove this. Backend uses it for conditional Level 2 fields. Need to either: (a) Remove form_level concept entirely, (b) Make it internal-only field.
5. **business_owner / technical_owner** - Clearly remove these.

---

## Priority Matrix

### P0: Critical - Blockers for Customer Acceptance (10 items)

| # | Field | Section | Effort | Dependency |
|---|-------|---------|--------|------------|
| 1 | Ph·∫°m vi - Make REQUIRED | Section 1 | 2h | Backend migration |
| 2 | Nh√≥m h·ªá th·ªëng - Update 8 options | Section 1 | 2h | Backend migration |
| 3 | T·ªïng s·ªë t√†i kho·∫£n | Section 2 | 1h | Form add only (backend exists) |
| 4 | MAU (Monthly Active Users) | Section 2 | 1h | Form add only (backend exists) |
| 5 | DAU (Daily Active Users) | Section 2 | 1h | Form add only (backend exists) |
| 6 | S·ªë ƒë∆°n v·ªã/ƒë·ªãa ph∆∞∆°ng | Section 2 | 1h | Form add only (backend exists) |
| 7 | Dung l∆∞·ª£ng DB hi·ªán t·∫°i | Section 4 | 1h | Form add only (backend exists) |
| 8 | Dung l∆∞·ª£ng file ƒë√≠nh k√®m | Section 4 | 3h | Backend + Form |
| 9 | T·ªëc ƒë·ªô tƒÉng tr∆∞·ªüng | Section 4 | 1h | Form add only (backend exists) |
| 10 | Danh s√°ch t√≠ch h·ª£p chi ti·∫øt | Section 5 | 8h | New dynamic form component |

**Total P0 Effort:** ~21 hours (~3 days)

### P1: High - Important for Completeness (25 items)

| # | Field | Section | Effort |
|---|-------|---------|--------|
| 1 | Ng√†y v·∫≠n h√†nh - Month/Year only | Section 1 | 4h (custom widget) |
| 2 | S·ªë l·∫ßn n√¢ng c·∫•p | Section 1 | 3h (backend + form) |
| 3 | Th·ªùi gian n√¢ng c·∫•p g·∫ßn nh·∫•t | Section 1 | 3h (backend + form) |
| 4 | Lo·∫°i ki·∫øn tr√∫c - Add Serverless, SaaS | Section 3 | 2h (model update) |
| 5 | C√≥ ph√¢n l·ªõp kh√¥ng | Section 3 | 3h (backend + form) |
| 6 | Multi-tenant | Section 3 | 2h (backend + form) |
| 7 | Container h√≥a | Section 3 | 3h (backend + form) |
| 8 | Frontend tech stack + version | Section 3 | 1h (form add only) |
| 9 | Backend tech stack + version | Section 3 | 1h (form add only) |
| 10 | API style | Section 3 | 3h (backend + form) |
| 11-17 | Messaging, Cache, Search, Reporting/BI, Repository, CI/CD, T·ª± ƒë·ªông h√≥a ki·ªÉm th·ª≠ | Section 3 | 14h (7 fields √ó 2h) |
| 18-22 | DB ch√≠nh + version, DB ph·ª•, L∆∞u file, S·ªë b·∫£n ghi, Retention | Section 4 | 10h |
| 23-24 | N∆°i ƒë·∫∑t, Compute | Section 6 | 4h |
| 25-26 | Ph√¢n lo·∫°i h·ªá th·ªëng, H·ªì s∆° ATTT | Section 7 | 4h |

**Total P1 Effort:** ~60 hours (~8 days)

### P2: Medium - Nice to Have (16 items)

| Category | Items | Effort |
|----------|-------|--------|
| Section 3 - Branching model, detailed tech specs | 3 fields | 6h |
| Section 4 - Danh m·ª•c d√πng chung, D·ªØ li·ªáu master, ERD upload | 3 fields | 6h |
| Section 5 - API gateway, API docs, versioning standards | 3 fields | 6h |
| Section 8 - ƒê√°nh gi√° n·ª£ k·ªπ thu·∫≠t (entire new section) | 3 fields | 8h |
| Cleanup - Remove unused fields (form_level, business_owner, etc.) | 4 fields | 4h |

**Total P2 Effort:** ~30 hours (~4 days)

---

## Implementation Roadmap

### Phase 1: Critical Gaps (Week 1)
**Goal:** Fix P0 blockers - missing required fields

1. **Backend Migration (Day 1-2)**
   - [ ] Add migration for new fields:
     - System.num_upgrades
     - System.last_upgrade_date
     - SystemDataInfo.file_storage_size_gb
     - SystemDataInfo.api_provided_count
     - SystemDataInfo.api_consumed_count
   - [ ] Update System.scope to `blank=False, null=False`
   - [ ] Update GROUP_CHOICES with 8 new options
   - [ ] Add System.security_level (enum 1-5)
   - [ ] Add System.has_security_documents

2. **Frontend - Add Missing Fields (Day 3-4)**
   - [ ] Section 1: Add Ph·∫°m vi (required), Nh√≥m h·ªá th·ªëng (required with 8 options)
   - [ ] Section 2: Add MAU, DAU, S·ªë ƒë∆°n v·ªã/ƒë·ªãa ph∆∞∆°ng (backend fields exist!)
   - [ ] Section 4: Add Dung l∆∞·ª£ng DB, Dung l∆∞·ª£ng file, T·ªëc ƒë·ªô tƒÉng tr∆∞·ªüng (backend exists!)

3. **Testing (Day 5)**
   - [ ] Test form submission with all new required fields
   - [ ] Test validation rules

**Deliverable:** Working form with all P0 fields functional

### Phase 2: Architecture & Data Sections (Week 2)
**Goal:** Implement P1 architecture and data fields

1. **Backend Expansion (Day 1-2)**
   - [ ] SystemArchitecture: Add has_layers, is_multi_tenant, container_type
   - [ ] Add new fields: api_style, messaging_queue, cache, search, reporting_bi
   - [ ] Add source_code_repo, has_cicd, cicd_tool, has_automated_testing
   - [ ] SystemDataInfo: Add secondary_databases, file_storage_type, record_count, retention_period

2. **Frontend - Section 3 Overhaul (Day 3-4)**
   - [ ] Redesign "Ki·∫øn tr√∫c c√¥ng ngh·ªá" tab
   - [ ] Add architecture type (Serverless, SaaS)
   - [ ] Add layered architecture checkboxes
   - [ ] Add multi-tenant toggle
   - [ ] Add containerization detailed options
   - [ ] Add detailed tech stack fields (frontend, backend with versions)
   - [ ] Add API style, messaging, cache, search, reporting/BI
   - [ ] Add auth methods (already exists, just move to correct section)
   - [ ] Add repository, CI/CD, testing automation fields

3. **Frontend - Section 4 Overhaul (Day 5)**
   - [ ] Redesign "Ki·∫øn tr√∫c d·ªØ li·ªáu" tab
   - [ ] Add DB ch√≠nh + version
   - [ ] Add DB ph·ª• (dynamic list)
   - [ ] Add L∆∞u file options
   - [ ] Add required data volume fields
   - [ ] Add ERD upload toggle
   - [ ] Add danh m·ª•c d√πng chung, d·ªØ li·ªáu master, PII fields

**Deliverable:** Comprehensive architecture and data sections

### Phase 3: Integration & Operations (Week 3)
**Goal:** Implement complex integration matrix and operations fields

1. **Backend - Integration Expansion (Day 1-2)**
   - [ ] Create new model: SystemIntegrationConnection (dynamic list)
     - source_system, target_system
     - data_objects_exchanged
     - integration_method (API/file/DB link/manual)
     - frequency (real-time/batch)
     - sync_error_handling
     - has_api_documentation
   - [ ] Add SystemDataInfo.api_gateway_exists
   - [ ] Add SystemDataInfo.api_versioning_standards

2. **Frontend - Section 5 Dynamic Form (Day 3-4)**
   - [ ] Create dynamic integration connection form component
   - [ ] Add/remove multiple connections
   - [ ] Add API inventory fields (provided/consumed counts)
   - [ ] Add API gateway, versioning, throttling fields

3. **Backend - Operations (Day 5)**
   - [ ] Add SystemOperations.deployment_location (DC/Cloud/Hybrid)
   - [ ] Add SystemOperations.compute_specifications

**Deliverable:** Dynamic integration form with operations fields

### Phase 4: Security & Technical Debt (Week 4)
**Goal:** Final security fields and technical debt assessment

1. **Backend - Security Expansion (Day 1)**
   - [ ] Already implemented security_level and has_security_documents (from Phase 1)

2. **Frontend - Section 7 (Day 2)**
   - [ ] Add security level dropdown (1-5)
   - [ ] Add security documents checkbox

3. **Backend - Technical Debt (Day 2)**
   - [ ] Create new model or add to SystemAssessment:
     - integration_readiness: JSONField (checkboxes)
     - blockers: JSONField (checkboxes)
     - recommendation: CharField (choices)

4. **Frontend - Section 8 NEW (Day 3)**
   - [ ] Create "ƒê√°nh gi√° m·ª©c n·ª£ k·ªπ thu·∫≠t" tab
   - [ ] Add "ƒêi·ªÉm ph√π h·ª£p" checkboxes (4 items)
   - [ ] Add "ƒêi·ªÉm v∆∞·ªõng" checkboxes (5 items)
   - [ ] Add "ƒê·ªÅ xu·∫•t" dropdown (4 options)

5. **Cleanup & Testing (Day 4-5)**
   - [ ] Remove business_owner, technical_owner from form
   - [ ] Remove form_level from form (or make internal)
   - [ ] Comprehensive testing
   - [ ] Customer demo and feedback

**Deliverable:** Complete form matching customer requirements

---

## Database Migration Requirements

### New Migration File: `0003_add_customer_feedback_fields.py`

```python
from django.db import migrations, models

class Migration(migrations.Migration):
    dependencies = [
        ('systems', '0002_add_p08_fields'),
    ]

    operations = [
        # SECTION 1
        migrations.AlterField(
            model_name='system',
            name='scope',
            field=models.CharField(max_length=50, choices=[...], blank=False),  # Make required
        ),
        migrations.AlterField(
            model_name='system',
            name='system_group',
            field=models.CharField(max_length=50, choices=[...8 new options...], blank=False),  # Make required + update choices
        ),
        migrations.AddField(
            model_name='system',
            name='num_upgrades',
            field=models.IntegerField(default=0, verbose_name='S·ªë l·∫ßn n√¢ng c·∫•p'),
        ),
        migrations.AddField(
            model_name='system',
            name='last_upgrade_date',
            field=models.DateField(null=True, blank=True, verbose_name='Th·ªùi gian n√¢ng c·∫•p g·∫ßn nh·∫•t'),
        ),

        # SECTION 2 - User metrics (backend fields exist, just need in form)
        # No backend changes needed for MAU, DAU, num_organizations

        # SECTION 3 - Architecture
        migrations.AddField(
            model_name='systemarchitecture',
            name='has_layers',
            field=models.BooleanField(default=False, verbose_name='C√≥ ph√¢n l·ªõp kh√¥ng?'),
        ),
        migrations.AddField(
            model_name='systemarchitecture',
            name='layer_presentation',
            field=models.BooleanField(default=False),
        ),
        migrations.AddField(
            model_name='systemarchitecture',
            name='layer_business',
            field=models.BooleanField(default=False),
        ),
        migrations.AddField(
            model_name='systemarchitecture',
            name='layer_data',
            field=models.BooleanField(default=False),
        ),
        migrations.AddField(
            model_name='systemarchitecture',
            name='layer_integration',
            field=models.BooleanField(default=False),
        ),
        migrations.AddField(
            model_name='systemarchitecture',
            name='is_multi_tenant',
            field=models.BooleanField(default=False, verbose_name='Multi-tenant'),
        ),
        migrations.AddField(
            model_name='systemarchitecture',
            name='container_type',
            field=models.CharField(max_length=50, choices=[('none', 'Kh√¥ng'), ('docker', 'Docker'), ('kubernetes', 'Kubernetes'), ('openshift', 'OpenShift'), ('other', 'Kh√°c')], default='none'),
        ),
        migrations.AddField(
            model_name='systemarchitecture',
            name='api_style',
            field=models.CharField(max_length=50, choices=[...], blank=True),
        ),
        migrations.AddField(
            model_name='systemarchitecture',
            name='messaging_queue',
            field=models.CharField(max_length=50, choices=[...], blank=True),
        ),
        # ... (add all other fields)

        # SECTION 4 - Data
        migrations.AddField(
            model_name='systemdatainfo',
            name='file_storage_size_gb',
            field=models.DecimalField(max_digits=10, decimal_places=2, null=True, blank=True),
        ),
        migrations.AddField(
            model_name='systemdatainfo',
            name='file_storage_type',
            field=models.CharField(max_length=50, choices=[...], blank=True),
        ),
        # ... (add all other fields)

        # SECTION 7 - Security
        migrations.AddField(
            model_name='system',
            name='security_level',
            field=models.IntegerField(choices=[(1, 'C·∫•p 1'), (2, 'C·∫•p 2'), (3, 'C·∫•p 3'), (4, 'C·∫•p 4'), (5, 'C·∫•p 5')], null=True, blank=True),
        ),
        migrations.AddField(
            model_name='system',
            name='has_security_documents',
            field=models.BooleanField(default=False),
        ),

        # SECTION 8 - Technical Debt
        migrations.AddField(
            model_name='systemassessment',
            name='integration_readiness',
            field=models.JSONField(default=list, blank=True),
        ),
        migrations.AddField(
            model_name='systemassessment',
            name='blockers',
            field=models.JSONField(default=list, blank=True),
        ),
        migrations.AddField(
            model_name='systemassessment',
            name='recommendation',
            field=models.CharField(max_length=50, choices=[('keep', 'Gi·ªØ nguy√™n'), ('upgrade', 'N√¢ng c·∫•p'), ('replace', 'Thay th·∫ø'), ('merge', 'H·ª£p nh·∫•t')], blank=True),
        ),
    ]
```

---

## Risk Assessment

### High Risk Items

| Risk | Impact | Probability | Mitigation |
|------|--------|-------------|------------|
| **Data loss during migration** | HIGH | LOW | Create backup, test migration on staging |
| **Breaking existing forms** | HIGH | MEDIUM | Keep old fields as deprecated, gradual migration |
| **Customer changes requirements again** | MEDIUM | HIGH | Get explicit sign-off BEFORE implementation |
| **Backend schema conflicts** | MEDIUM | LOW | Thorough code review, incremental migrations |
| **Frontend form becomes too complex** | MEDIUM | HIGH | Consider multi-step wizard instead of tabs |

### Medium Risk Items

| Risk | Impact | Probability | Mitigation |
|------|--------|-------------|------------|
| **Performance degradation with many fields** | MEDIUM | MEDIUM | Lazy load tabs, optimize validation |
| **User confusion with new fields** | MEDIUM | HIGH | Add tooltips, examples, help text |
| **Backend validation becomes complex** | LOW | MEDIUM | Extract validation to separate service layer |

---

## Action Items for Backlog

### Immediate Actions (This Week)

1. **[P0] Customer Confirmation**
   - [ ] Schedule meeting with customer to clarify:
     - Where to move "M·ª•c ƒë√≠ch / M√¥ t·∫£" field (customer said "ƒë∆∞a v√†o d∆∞·ªõi")
     - Confirm if "Ch·ªçn ƒê∆°n v·ªã" field should be completely hidden or just auto-filled
     - Confirm if "form_level" should be removed entirely or made internal-only
     - Get sign-off on proposed 8 "Nh√≥m h·ªá th·ªëng" options
   - [ ] Document all decisions
   - [ ] Create final requirements document

2. **[P0] Backend Preparation**
   - [ ] Create feature branch: `feature/p0.8-customer-feedback`
   - [ ] Review all existing backend models
   - [ ] Create migration plan
   - [ ] Estimate migration downtime (if any)

3. **[P0] Frontend Preparation**
   - [ ] Audit current form fields
   - [ ] Create field mapping document (current ‚Üí customer)
   - [ ] Design new tab structure (if needed)

### Short-term Actions (Next 2 Weeks)

4. **[P0] Implementation Sprint 1**
   - [ ] Implement all P0 fields (estimated 3 days)
   - [ ] Write unit tests for new fields
   - [ ] Update API documentation
   - [ ] Deploy to staging for testing

5. **[P1] Implementation Sprint 2**
   - [ ] Implement Section 3 (Architecture) - estimated 3 days
   - [ ] Implement Section 4 (Data) - estimated 2 days
   - [ ] Deploy to staging

### Medium-term Actions (Next 2-4 Weeks)

6. **[P1] Implementation Sprint 3**
   - [ ] Implement Section 5 (Integration) - estimated 3 days
   - [ ] Implement dynamic integration connection form
   - [ ] Deploy to staging

7. **[P1-P2] Final Sprint**
   - [ ] Implement remaining P1 fields
   - [ ] Implement P2 fields (if time permits)
   - [ ] Remove deprecated fields
   - [ ] Comprehensive testing
   - [ ] Customer acceptance testing
   - [ ] Deploy to production

---

## Summary Statistics

### Effort Breakdown

| Phase | Items | Backend Hours | Frontend Hours | Testing Hours | Total Hours |
|-------|-------|---------------|----------------|---------------|-------------|
| Phase 1 (P0) | 10 | 8 | 10 | 3 | **21 (3 days)** |
| Phase 2 (P1) | 17 | 16 | 20 | 5 | **41 (5 days)** |
| Phase 3 (P1) | 8 | 10 | 12 | 3 | **25 (3 days)** |
| Phase 4 (P1-P2) | 16 | 6 | 12 | 4 | **22 (3 days)** |
| **TOTAL** | **51 changes** | **40h** | **54h** | **15h** | **109h (~14 days)** |

**Recommended Timeline:** 3-4 weeks with 1 developer

**With 2 developers (Backend + Frontend split):** 2-3 weeks

**Buffer for unexpected issues + customer feedback:** Add 1 week

**Final Timeline:** 3-5 weeks total

---

## SECTION 9: Unit Account Management & Progress Dashboard (NEW P0 REQUIREMENT)

**Date Added:** 2026-01-20
**Priority:** P0 - Critical
**Type:** New Feature - Multi-tenant Account & Progress Tracking

**Additional Customer Feedback (2026-01-20):**

### Tab Reorganization Requirements

**Current Problem:** Current 8-tab structure has overlapping fields and unclear separation of concerns.

**Customer Feedback:**
1. > "ƒê√°nh gi√° th√†nh 1 m·ª•c (tab) ri√™ng em nh√©. Hi·ªán ƒëang b·ªã ƒë·ªÉ trong An to√†n th√¥ng tin"
   - **Issue:** Assessment fields mixed with Security fields
   - **Action:** Create separate "ƒê√°nh gi√°" tab

2. > "Tri·ªÉn khai & H·∫° t·∫ßng (P2 Gap Analysis) ƒëang c√≥ c√°c field h∆°i tr√πng l·∫∑p v·ªõi ph·∫ßn H·∫° t·∫ßng k·ªπ thu·∫≠t, merge v√†o th√†nh tab H·∫° t·∫ßng k·ªπ thu·∫≠t & tab Tri·ªÉn khai ri√™ng"
   - **Issue:** Deployment and Infrastructure fields overlapping
   - **Action:** Split into two distinct tabs

3. > "C√°c field trong tab Tri·ªÉn khai th√¨ ƒë∆∞a v√†o Th√¥ng tin chung"
   - **Issue:** Deployment fields belong in General Information
   - **Action:** Move deployment fields to Tab 1

**Proposed New Tab Structure (9 tabs total):**

| Tab # | Current Name | New Name | Fields | Changes |
|-------|-------------|----------|--------|---------|
| **Tab 1** | Th√¥ng tin chung | **Th√¥ng tin chung & Tri·ªÉn khai** | System name, code, status, scope, group, go_live_date, **+ deployment fields** | ‚ûï **Add deployment fields from old Tab 8** |
| **Tab 2** | M·ª•c ti√™u - Ph·∫°m vi - Ng∆∞·ªùi d√πng | M·ª•c ti√™u - Ph·∫°m vi - Ng∆∞·ªùi d√πng | business_objectives, user_types, annual_users, MAU, DAU | ‚úÖ **Keep as is** |
| **Tab 3** | Ki·∫øn tr√∫c c√¥ng ngh·ªá | Ki·∫øn tr√∫c c√¥ng ngh·ªá | programming_language, framework, database_name, backend_tech, frontend_tech, architecture_type, containerization | ‚úÖ **Keep as is (multi-select conversion done)** |
| **Tab 4** | Ki·∫øn tr√∫c d·ªØ li·ªáu | Ki·∫øn tr√∫c d·ªØ li·ªáu | data_classification_type, data_volume, data_sources, file_storage, DB specs | ‚úÖ **Keep as is** |
| **Tab 5** | T√≠ch h·ª£p - Li√™n th√¥ng | T√≠ch h·ª£p - Li√™n th√¥ng | integrated_systems, API list, data_exchange_method, integration connections | ‚úÖ **Keep as is** |
| **Tab 6** | An to√†n th√¥ng tin | **An to√†n th√¥ng tin** | authentication_method, has_encryption, has_audit_log, compliance_standards, **security_level, has_security_documents** | ‚ùå **Remove assessment fields** ‚Üí Move to Tab 9 |
| **Tab 7** | ~~V·∫≠n h√†nh~~ | **H·∫° t·∫ßng k·ªπ thu·∫≠t** | server_specs, hosting_platform, compute_config, storage_capacity, network_config | üîÑ **Rename + focus on infrastructure hardware** |
| **Tab 8** | ~~Tri·ªÉn khai & H·∫° t·∫ßng (P2)~~ | **V·∫≠n h√†nh & H·ªó tr·ª£** | support_team, support_level, maintenance_schedule, SLA, monitoring | üîÑ **Rename + focus on operations/support** |
| **Tab 9** | ‚ùå (NEW) | **ƒê√°nh gi√° & N·ª£ k·ªπ thu·∫≠t** | integration_readiness, blockers, recommendation, technical_debt_score | ‚ûï **NEW TAB for assessment** |

**Detailed Changes:**

### Tab 1: Th√¥ng tin chung & Tri·ªÉn khai (General Information & Deployment)
**Add deployment fields:**
- Ng√†y tri·ªÉn khai (Deployment date)
- Phi√™n b·∫£n hi·ªán t·∫°i (Current version)
- L·ªãch s·ª≠ n√¢ng c·∫•p (Upgrade history)
- M√¥i tr∆∞·ªùng tri·ªÉn khai (Deployment environment: dev/staging/prod)

**Rationale:** Deployment information is basic system information, belongs with general info

### Tab 6: An to√†n th√¥ng tin (Security) - Cleanup
**Remove:**
- ‚ùå integration_readiness (move to Tab 9)
- ‚ùå blockers (move to Tab 9)
- ‚ùå recommendation (move to Tab 9)

**Keep:**
- ‚úÖ authentication_method
- ‚úÖ has_encryption
- ‚úÖ has_audit_log
- ‚úÖ compliance_standards_list
- ‚úÖ security_level (1-5)
- ‚úÖ has_security_documents

**Rationale:** Focus purely on security/ATTT, remove technical debt assessment

### Tab 7: H·∫° t·∫ßng k·ªπ thu·∫≠t (Technical Infrastructure) - Rename & Focus
**Current fields (from old Tab 7 "V·∫≠n h√†nh"):**
- server_configuration
- hosting_platform (already in Tab 3)
- compute_type
- storage_capacity

**Add from old "Tri·ªÉn khai & H·∫° t·∫ßng":**
- Number of VMs
- CPU/RAM specs
- Operating system
- Network configuration
- Storage type (SAN/NAS/Object Storage)

**Remove duplication:**
- hosting_platform (keep in Tab 3 only)

**Rationale:** Pure infrastructure/hardware specs in one place

### Tab 8: V·∫≠n h√†nh & H·ªó tr·ª£ (Operations & Support) - Rename & Focus
**Keep:**
- has_support_team
- support_level
- support_hours

**Add:**
- Maintenance schedule
- Backup schedule
- Monitoring tools
- Alert configuration
- SLA requirements

**Remove:**
- ‚ùå business_owner (customer requested removal)
- ‚ùå technical_owner (customer requested removal)

**Rationale:** Focus on day-to-day operations and support

### Tab 9: ƒê√°nh gi√° & N·ª£ k·ªπ thu·∫≠t (Assessment & Technical Debt) - NEW
**Move from Tab 6:**
- integration_readiness (checkboxes: easy to standardize, has good APIs, data traceable, can separate services)
- blockers (checkboxes: legacy tech, no docs, no APIs, dirty data, vendor lock-in)
- recommendation (select: keep/upgrade/replace/merge)

**Add new fields:**
- Technical debt score (calculated)
- Modernization priority (high/medium/low)
- Assessment date
- Assessment notes

**Rationale:** Complete section dedicated to system evaluation and future planning

### Customer Requirements

**Customer Request (Vietnamese):**
> C·∫•p t√†i kho·∫£n t·ªõi c√°c ƒë∆°n v·ªã (U+P). ƒê∆°n v·ªã login v√†o v√† b√°o c√°o bao nhi√™u h·ªá th·ªëng. Dashboard ƒë∆°n v·ªã s·∫Ω th·∫•y c√≥ bao nhi√™u h·ªá th·ªëng, t·ªïng ƒë√£ b√°o c√°o ƒëc bao nhi√™u % c√°c tr∆∞·ªùng. Danh s√°ch t·ª´ng h·ªá th·ªëng v√† % ƒë√£ b√°o c√°o ƒë·ªß th√¥ng tin. Nh·∫≠p xong Tab n√†y m·ªõi sang Tab kia ƒë·ªÉ tr√°nh b·ªè s√≥t.

**Translation:**
1. **Create accounts for units** (Username + Password)
2. **Units login and report systems** - Each unit can report multiple systems
3. **Unit dashboard shows:**
   - Total number of systems reported by this unit
   - Overall completion percentage across all fields
   - List of each system with individual completion percentage
4. **Tab validation:** Force users to complete current tab before moving to next tab (prevent skipping)

### Feature Breakdown

#### F1: Unit Account Management System

| Feature Component | Description | Implementation | Priority |
|------------------|-------------|----------------|----------|
| **User Registration** | Create accounts for different units/organizations | Django User model + Organization FK | P0 |
| **Role-Based Access** | Unit users can only see/edit their own systems | Django permissions + queryset filtering | P0 |
| **Admin Panel** | Super admin can create unit accounts | Extend Django Admin | P0 |
| **Authentication** | Login with username/password | Already exists (Django Auth) | ‚úÖ DONE |
| **Session Management** | Secure session handling | Already exists | ‚úÖ DONE |

#### F2: Unit Progress Dashboard

| Feature Component | Description | Implementation | Priority |
|------------------|-------------|----------------|----------|
| **Dashboard View** | New page showing unit's systems and progress | New React component + API endpoint | P0 |
| **System Count** | Display total systems created by unit | COUNT query with org filter | P0 |
| **Overall Completion %** | Average completion across all systems | Aggregate calculation | P0 |
| **Per-System Progress** | List table with system name + % complete | JSONField analysis + table component | P0 |
| **Progress Calculation** | Calculate % of required fields filled | Backend utility function | P0 |

#### F3: Tab-by-Tab Validation (Form UX Improvement)

| Feature Component | Description | Implementation | Priority |
|------------------|-------------|----------------|----------|
| **Tab Lock Mechanism** | Disable next tab until current tab is complete | Ant Design Tabs + validation logic | P0 |
| **Required Field Tracking** | Identify which fields are required per tab | Form configuration + validation | P0 |
| **Visual Indicators** | Show ‚úÖ/‚ùå/‚ö†Ô∏è on tab labels | Tab icon rendering based on validation | P1 |
| **Validation Messages** | Clear error messages for incomplete tabs | Ant Design Message/Notification | P1 |
| **Save Draft** | Allow partial save without validation | Separate API endpoint | P1 |

### Technical Design

#### Backend Models

**No major changes to System model** - Already has `org` foreign key for filtering.

**New utility function: `calculate_system_completion_percentage()`**

```python
# apps/systems/utils.py

REQUIRED_FIELDS_MAP = {
    'tab1': ['system_name', 'system_name_en', 'status', 'scope', 'system_group'],
    'tab2': ['business_objectives', 'user_types', 'annual_users'],
    'tab3': ['programming_language', 'framework', 'database_name', 'hosting_platform'],
    'tab4': ['data_classification_type', 'data_volume'],
    'tab5': ['integrated_internal_systems', 'data_exchange_method'],
    'tab6': ['authentication_method', 'has_encryption'],
    'tab7': ['has_support_team', 'support_level'],
    'tab8': [],  # Optional tab
}

def calculate_system_completion_percentage(system_instance):
    """Calculate % of required fields filled for a system"""
    total_required = 0
    total_filled = 0

    for tab_fields in REQUIRED_FIELDS_MAP.values():
        for field_name in tab_fields:
            total_required += 1
            value = getattr(system_instance, field_name, None)

            # Check if field is filled
            if value is not None:
                if isinstance(value, str) and value.strip():
                    total_filled += 1
                elif isinstance(value, list) and len(value) > 0:
                    total_filled += 1
                elif isinstance(value, bool):  # Boolean fields always count as filled
                    total_filled += 1
                elif isinstance(value, (int, float)) and value > 0:
                    total_filled += 1

    return round((total_filled / total_required) * 100, 1) if total_required > 0 else 0.0
```

#### Backend API Endpoints

**New endpoints:**

```python
# apps/systems/urls.py
urlpatterns = [
    # ... existing endpoints
    path('dashboard/unit-progress/', UnitProgressDashboardView.as_view(), name='unit-progress'),
]

# apps/systems/views.py
class UnitProgressDashboardView(APIView):
    permission_classes = [IsAuthenticated]

    def get(self, request):
        user = request.user
        org = user.profile.organization  # Assuming user has organization FK

        # Get all systems for this organization
        systems = System.objects.filter(org=org)

        # Calculate progress for each system
        system_progress = []
        for system in systems:
            completion_pct = calculate_system_completion_percentage(system)
            system_progress.append({
                'id': system.id,
                'system_name': system.system_name,
                'system_code': system.system_code,
                'status': system.status,
                'completion_percentage': completion_pct,
                'created_at': system.created_at,
                'updated_at': system.updated_at,
            })

        # Calculate overall completion
        total_systems = len(system_progress)
        overall_completion = sum(s['completion_percentage'] for s in system_progress) / total_systems if total_systems > 0 else 0

        return Response({
            'organization': {
                'id': org.id,
                'name': org.name,
            },
            'total_systems': total_systems,
            'overall_completion_percentage': round(overall_completion, 1),
            'systems': system_progress,
        })
```

#### Frontend Components

**New component: `/frontend/src/pages/UnitDashboard.tsx`**

```typescript
import React, { useEffect, useState } from 'react';
import { Card, Table, Progress, Statistic, Row, Col, Tag } from 'antd';
import { CheckCircleOutlined, ClockCircleOutlined } from '@ant-design/icons';
import api from '../services/api';

interface SystemProgress {
  id: number;
  system_name: string;
  system_code: string;
  status: string;
  completion_percentage: number;
  updated_at: string;
}

const UnitDashboard: React.FC = () => {
  const [loading, setLoading] = useState(true);
  const [data, setData] = useState<any>(null);

  useEffect(() => {
    fetchDashboardData();
  }, []);

  const fetchDashboardData = async () => {
    try {
      const response = await api.get('/systems/dashboard/unit-progress/');
      setData(response.data);
    } catch (error) {
      console.error('Error fetching dashboard:', error);
    } finally {
      setLoading(false);
    }
  };

  const columns = [
    {
      title: 'M√£ h·ªá th·ªëng',
      dataIndex: 'system_code',
      key: 'system_code',
    },
    {
      title: 'T√™n h·ªá th·ªëng',
      dataIndex: 'system_name',
      key: 'system_name',
    },
    {
      title: 'Tr·∫°ng th√°i',
      dataIndex: 'status',
      key: 'status',
      render: (status: string) => (
        <Tag color={status === 'production' ? 'green' : 'orange'}>
          {status === 'production' ? 'V·∫≠n h√†nh' : 'Ph√°t tri·ªÉn'}
        </Tag>
      ),
    },
    {
      title: 'Ti·∫øn ƒë·ªô b√°o c√°o',
      dataIndex: 'completion_percentage',
      key: 'completion_percentage',
      render: (pct: number) => <Progress percent={pct} size="small" />,
    },
    {
      title: 'C·∫≠p nh·∫≠t',
      dataIndex: 'updated_at',
      key: 'updated_at',
      render: (date: string) => new Date(date).toLocaleDateString('vi-VN'),
    },
  ];

  return (
    <div style={{ padding: 24 }}>
      <h1>Dashboard B√°o c√°o H·ªá th·ªëng - {data?.organization?.name}</h1>

      <Row gutter={[16, 16]} style={{ marginBottom: 24 }}>
        <Col span={8}>
          <Card>
            <Statistic
              title="T·ªïng s·ªë h·ªá th·ªëng"
              value={data?.total_systems || 0}
              prefix={<CheckCircleOutlined />}
            />
          </Card>
        </Col>
        <Col span={8}>
          <Card>
            <Statistic
              title="Ti·∫øn ƒë·ªô ho√†n th√†nh trung b√¨nh"
              value={data?.overall_completion_percentage || 0}
              suffix="%"
              prefix={<ClockCircleOutlined />}
            />
          </Card>
        </Col>
        <Col span={8}>
          <Card>
            <Statistic
              title="H·ªá th·ªëng ho√†n thi·ªán 100%"
              value={data?.systems?.filter((s: SystemProgress) => s.completion_percentage === 100).length || 0}
              valueStyle={{ color: '#3f8600' }}
            />
          </Card>
        </Col>
      </Row>

      <Card title="Danh s√°ch h·ªá th·ªëng">
        <Table
          loading={loading}
          dataSource={data?.systems || []}
          columns={columns}
          rowKey="id"
        />
      </Card>
    </div>
  );
};

export default UnitDashboard;
```

**Enhanced Form Validation: `/frontend/src/pages/SystemCreate.tsx`**

Add tab validation logic:

```typescript
const [activeTab, setActiveTab] = useState('1');
const [tabsCompleted, setTabsCompleted] = useState<{ [key: string]: boolean }>({
  '1': false,
  '2': false,
  '3': false,
  '4': false,
  '5': false,
  '6': false,
  '7': false,
  '8': true, // Tab 8 is optional
});

const validateTab = async (tabKey: string) => {
  const fieldsToValidate = REQUIRED_FIELDS_MAP[`tab${tabKey}`];
  try {
    await form.validateFields(fieldsToValidate);
    setTabsCompleted(prev => ({ ...prev, [tabKey]: true }));
    return true;
  } catch (error) {
    message.error(`Vui l√≤ng ho√†n th√†nh c√°c tr∆∞·ªùng b·∫Øt bu·ªôc trong tab n√†y tr∆∞·ªõc khi chuy·ªÉn sang tab ti·∫øp theo`);
    return false;
  }
};

const handleTabChange = async (newTabKey: string) => {
  const currentTabIndex = parseInt(activeTab);
  const newTabIndex = parseInt(newTabKey);

  // If moving forward, validate current tab first
  if (newTabIndex > currentTabIndex) {
    const isValid = await validateTab(activeTab);
    if (!isValid) return; // Block tab change
  }

  setActiveTab(newTabKey);
};

// Add visual indicators to tabs
const getTabIcon = (tabKey: string) => {
  if (tabsCompleted[tabKey]) {
    return <CheckCircleOutlined style={{ color: 'green' }} />;
  } else {
    return <ClockCircleOutlined style={{ color: 'orange' }} />;
  }
};
```

### Implementation Roadmap

#### Phase 1: Account Management & Permissions (2 days)

1. **Day 1 Morning: Backend User/Org Setup**
   - [ ] Ensure Organization model exists with proper fields
   - [ ] Ensure User profile has organization FK
   - [ ] Create admin interface for creating unit accounts
   - [ ] Add org-level filtering to System queryset

2. **Day 1 Afternoon: Frontend Login/Auth**
   - [ ] Verify login flow works
   - [ ] Add organization info to user context
   - [ ] Test role-based access control

3. **Day 2 Morning: Admin Panel Enhancement**
   - [ ] Django Admin: Bulk create unit accounts
   - [ ] Email notification for new accounts (optional)
   - [ ] Password reset flow

4. **Day 2 Afternoon: Testing**
   - [ ] Create test units
   - [ ] Verify data isolation between units
   - [ ] Security testing

#### Phase 2: Dashboard Implementation (3 days)

1. **Day 3 Morning: Backend Progress Calculation**
   - [ ] Implement `calculate_system_completion_percentage()` utility
   - [ ] Define `REQUIRED_FIELDS_MAP` for all tabs
   - [ ] Unit tests for calculation logic

2. **Day 3 Afternoon: Backend API Endpoint**
   - [ ] Create `UnitProgressDashboardView` API
   - [ ] Add org filtering
   - [ ] Serialize system progress data
   - [ ] API tests

3. **Day 4 Morning: Frontend Dashboard Component**
   - [ ] Create `UnitDashboard.tsx` page
   - [ ] Add to routing
   - [ ] Implement statistics cards
   - [ ] Implement systems table with progress bars

4. **Day 4 Afternoon: UI Polish**
   - [ ] Add charts/visualizations (optional)
   - [ ] Responsive design
   - [ ] Loading states
   - [ ] Error handling

5. **Day 5: Dashboard Testing & Integration**
   - [ ] End-to-end testing
   - [ ] Performance testing with large datasets
   - [ ] Deploy to staging

#### Phase 3: Tab Validation (2 days)

1. **Day 6 Morning: Form Validation Logic**
   - [ ] Define required fields per tab in `REQUIRED_FIELDS_MAP`
   - [ ] Implement `validateTab()` function
   - [ ] Add tab change handler with validation

2. **Day 6 Afternoon: UI Indicators**
   - [ ] Add ‚úÖ/‚ö†Ô∏è icons to tab labels
   - [ ] Show validation errors in Ant Design Messages
   - [ ] Disable next tab if current incomplete
   - [ ] "Save Draft" button for partial saves

3. **Day 7: Testing & Deployment**
   - [ ] Test tab validation flow
   - [ ] Test save draft functionality
   - [ ] User acceptance testing
   - [ ] Deploy to production

### Estimated Effort

| Task | Backend | Frontend | Testing | Total |
|------|---------|----------|---------|-------|
| **Account Management** | 4h | 2h | 2h | **8h (1 day)** |
| **Dashboard** | 6h | 8h | 4h | **18h (2.5 days)** |
| **Tab Validation** | 2h | 6h | 4h | **12h (1.5 days)** |
| **TOTAL** | 12h | 16h | 10h | **38h (~5 days)** |

### Priority Assessment

**This is P0 CRITICAL** because:
1. Customer explicitly requested it
2. Impacts user experience significantly (tab validation)
3. Core feature for multi-unit deployment
4. Dashboard provides visibility into data quality

**Should be implemented BEFORE multi-select conversion** to ensure proper foundation for unit-based workflows.

---

## Next Steps

1. **Immediate:** Schedule customer meeting for clarification
2. **Week 1:** Implement P0 critical blockers + **Unit Account Management & Dashboard (NEW)**
3. **Week 2-3:** Implement P1 architecture and data sections
4. **Week 4:** Implement integration and final sections
5. **Week 5:** Testing, customer acceptance, deployment

**Success Criteria:**
- [ ] All P0 fields implemented and tested
- [ ] Unit account management working with proper data isolation
- [ ] Unit dashboard showing accurate progress tracking
- [ ] Tab-by-tab validation preventing incomplete submissions
- [ ] Customer signs off on form structure
- [ ] No data loss during migration
- [ ] All existing functionality preserved
- [ ] Performance impact < 10% on form load

---

**End of Gap Analysis Report**

**Generated:** 2026-01-19
**Updated:** 2026-01-20 (Added Section 9: Unit Account Management)
**Status:** Ready for implementation planning
**Confidence:** 85% (pending customer clarification on open questions)
