# P0.8: System Form Redesign - Implementation Plan

**Priority:** P0.8 (HIGHEST - Customer Request)
**Status:** PENDING CUSTOMER REVIEW
**Date:** 2026-01-18
**Source:** Customer Feedback (07-resources/customer-feedback-system-form-2026-01-18.md)
**Estimated Effort:** 20-30 hours
**Complexity:** HIGH - Major form redesign with ~44 field-level changes

---

## üìä Executive Summary

Customer y√™u c·∫ßu redesign to√†n b·ªô form "Th√™m h·ªá th·ªëng m·ªõi" v·ªõi:
- **Remove:** 6 tr∆∞·ªùng kh√¥ng c·∫ßn thi·∫øt
- **Add:** 30+ tr∆∞·ªùng m·ªõi (business context, architecture, data, integration, security)
- **Modify:** 5 tr∆∞·ªùng hi·ªán c√≥ (required, options, format)

**Impact Analysis:**
- **Backend:** Database schema changes (migrations), model updates, validation logic
- **Frontend:** Form redesign, new components, validation, UX improvements
- **Data Migration:** Existing systems need to be updated with new fields (nullable or default values)

---

## üéØ Detailed Analysis & Implementation Strategy

### SECTION 1: Th√¥ng tin c∆° b·∫£n (Basic Information)

#### 1.1. REMOVE: Ch·ªçn ƒê∆°n v·ªã

**Customer Feedback:**
> "B·ªè Ch·ªçn ƒê∆°n v·ªã v√¨ T√†i kho·∫£n ƒë∆°n v·ªã n√†o th√¨ m·∫∑c ƒë·ªãnh c√≥ r·ªìi m√†?"

**Analysis:**
- ‚úÖ **ƒê·ªìng √Ω:** Org user ch·ªâ thu·ªôc 1 organization, kh√¥ng c·∫ßn ch·ªçn
- ‚úÖ **Logic:** L·∫•y `organization_id` t·ª´ `request.user.organization_id`
- ‚ö†Ô∏è **Exception:** Admin C√ì TH·ªÇ c·∫ßn ch·ªçn ƒë∆°n v·ªã khi t·∫°o h·ªá th·ªëng cho ƒë∆°n v·ªã kh√°c

**Implementation:**
```python
# Backend: apps/systems/views.py
def create_system(request):
    if request.user.role == 'admin':
        # Admin MUST choose organization
        organization_id = request.data.get('organization_id')
        if not organization_id:
            return Response({'error': 'Admin must select organization'}, 400)
    else:
        # Org user: auto-fill from user's organization
        organization_id = request.user.organization_id

    system = System.objects.create(
        organization_id=organization_id,
        # ... other fields
    )
```

```tsx
// Frontend: SystemForm.tsx
{currentUser?.role === 'admin' ? (
  <Form.Item
    label="ƒê∆°n v·ªã"
    name="organization_id"
    rules={[{ required: true, message: 'Vui l√≤ng ch·ªçn ƒë∆°n v·ªã' }]}
  >
    <Select placeholder="Ch·ªçn ƒë∆°n v·ªã">
      {organizations.map(org => (
        <Option key={org.id} value={org.id}>{org.name}</Option>
      ))}
    </Select>
  </Form.Item>
) : (
  // Org user: hidden field, auto-filled
  <input type="hidden" name="organization_id" value={currentUser.organization_id} />
)}
```

**Decision:**
- ‚úÖ **Org User:** B·ªè field, auto-fill t·ª´ user session
- ‚úÖ **Admin:** GI·ªÆ field (required) ƒë·ªÉ admin c√≥ th·ªÉ t·∫°o h·ªá th·ªëng cho b·∫•t k·ª≥ ƒë∆°n v·ªã n√†o

---

#### 1.2. REMOVE: M√£ H·ªá th·ªëng

**Customer Feedback:**
> "B·ªè M√£ H·ªá th·ªëng v√¨ c√°i n√†y h·ªá th·ªëng t·ª± sinh ra ch·ª© ƒë∆°n v·ªã ko t·ª± ƒë·∫∑t t√™n n√≥ lo·∫°n"

**Analysis:**
- ‚úÖ **ƒê·ªìng √Ω:** Tr√°nh duplicate, conflict, kh√¥ng consistent
- ‚úÖ **Auto-generate:** Theo pattern: `SYS-{ORG_CODE}-{YYYY}-{XXXX}`
  - Example: `SYS-SKHCN-HN-2026-0001`

**Implementation:**
```python
# Backend: apps/systems/models.py
class System(models.Model):
    code = models.CharField(max_length=50, unique=True, editable=False)

    def save(self, *args, **kwargs):
        if not self.code:
            # Generate code: SYS-{ORG_CODE}-{YYYY}-{SEQUENCE}
            year = datetime.now().year
            org_code = self.organization.code
            last_system = System.objects.filter(
                organization=self.organization,
                code__startswith=f'SYS-{org_code}-{year}'
            ).order_by('-code').first()

            if last_system:
                last_seq = int(last_system.code.split('-')[-1])
                new_seq = last_seq + 1
            else:
                new_seq = 1

            self.code = f'SYS-{org_code}-{year}-{new_seq:04d}'

        super().save(*args, **kwargs)
```

```tsx
// Frontend: Remove code input field completely
// Code will be generated by backend and displayed after creation
```

**Decision:**
- ‚úÖ B·ªè input field
- ‚úÖ Auto-generate tr√™n backend
- ‚úÖ Display code after creation (read-only)

---

#### 1.3. KEEP: T√™n H·ªá th·ªëng

**Customer Feedback:**
> "T√™n H·ªá th·ªëng: Ok"

**Implementation:**
- ‚úÖ Gi·ªØ nguy√™n
- ‚úÖ Required field
- ‚úÖ Max length: 200 characters

---

#### 1.4. ADD: T√™n ti·∫øng Anh

**Customer Feedback:**
> "T√™n ti·∫øng Anh: Th√™m v√†o (n·∫øu c√≥)"

**Analysis:**
- ‚úÖ Optional field (n·∫øu c√≥)
- ‚úÖ Useful cho b√°o c√°o qu·ªëc t·∫ø, t√†i li·ªáu

**Implementation:**
```python
# Backend: apps/systems/models.py
class System(models.Model):
    # ... existing fields
    name = models.CharField(max_length=200)
    name_en = models.CharField(max_length=200, blank=True, null=True)  # NEW
```

```tsx
// Frontend: SystemForm.tsx
<Form.Item
  label="T√™n H·ªá th·ªëng"
  name="name"
  rules={[{ required: true, message: 'Vui l√≤ng nh·∫≠p t√™n h·ªá th·ªëng' }]}
>
  <Input placeholder="VD: H·ªá th·ªëng Qu·∫£n l√Ω VƒÉn b·∫£n" />
</Form.Item>

<Form.Item
  label="T√™n ti·∫øng Anh"
  name="name_en"
  tooltip="T√πy ch·ªçn - d√πng cho b√°o c√°o qu·ªëc t·∫ø"
>
  <Input placeholder="VD: Document Management System" />
</Form.Item>
```

**Decision:**
- ‚úÖ Add field `name_en` (optional)
- ‚úÖ Hi·ªÉn th·ªã ngay sau "T√™n H·ªá th·ªëng"

---

#### 1.5. REMOVE: M·ª•c ƒë√≠ch / M√¥ t·∫£

**Customer Feedback:**
> "M·ª•c ƒë√≠ch / M√¥ t·∫£: B·ªè ph·∫ßn n√†y ƒë∆∞a v√†o d∆∞·ªõi"

**Analysis:**
- ‚úÖ Di chuy·ªÉn v√†o Section 2: "M·ª•c ti√™u nghi·ªáp v·ª•"
- ‚úÖ Thay b·∫±ng field "M·ª•c ti√™u nghi·ªáp v·ª•" (5 bullet points)

**Decision:**
- ‚úÖ Remove t·ª´ Section 1
- ‚úÖ Replace v·ªõi "M·ª•c ti√™u nghi·ªáp v·ª•" ·ªü Section 2

---

#### 1.6. MODIFY: Ph·∫°m vi ‚Üí Required

**Customer Feedback:**
> "Ph·∫°m vi: Cho th√†nh tr∆∞·ªùng B·∫Øt bu·ªôc"

**Implementation:**
```python
# Backend: apps/systems/models.py
class System(models.Model):
    scope = models.CharField(max_length=20, choices=SCOPE_CHOICES)  # Remove blank=True
```

```tsx
// Frontend:
<Form.Item
  label="Ph·∫°m vi"
  name="scope"
  rules={[{ required: true, message: 'Vui l√≤ng ch·ªçn ph·∫°m vi' }]}  // Add required
>
  <Select placeholder="Ch·ªçn ph·∫°m vi">
    <Option value="ministry">To√†n B·ªô</Option>
    <Option value="department">C·∫•p V·ª•/C·ª•c</Option>
    <Option value="unit">ƒê∆°n v·ªã</Option>
  </Select>
</Form.Item>
```

**Decision:**
- ‚úÖ Make required (frontend + backend validation)

---

#### 1.7. MODIFY: Nh√≥m h·ªá th·ªëng ‚Üí Required + 8 Options

**Customer Feedback:**
> "Nh√≥m h·ªá th·ªëng: Cho th√†nh tr∆∞·ªùng B·∫Øt bu·ªôc. N·ªôi dung ch·ªçn bao g·ªìm: "N·ªÅn t·∫£ng qu·ªëc gia"; "N·ªÅn t·∫£ng d√πng chung c·ªßa B·ªô"; CSDL chuy√™n ng√†nh; "·ª®ng d·ª•ng nghi·ªáp v·ª•"; C·ªïng th√¥ng tin; BI/B√°o c√°o; ESB/T√≠ch h·ª£p; Kh√°c."

**Implementation:**
```python
# Backend: apps/systems/models.py
SYSTEM_GROUP_CHOICES = [
    ('national_platform', 'N·ªÅn t·∫£ng qu·ªëc gia'),
    ('ministry_platform', 'N·ªÅn t·∫£ng d√πng chung c·ªßa B·ªô'),
    ('specialized_db', 'CSDL chuy√™n ng√†nh'),
    ('business_app', '·ª®ng d·ª•ng nghi·ªáp v·ª•'),
    ('portal', 'C·ªïng th√¥ng tin'),
    ('bi_reporting', 'BI/B√°o c√°o'),
    ('esb_integration', 'ESB/T√≠ch h·ª£p'),
    ('other', 'Kh√°c'),
]

class System(models.Model):
    system_group = models.CharField(max_length=50, choices=SYSTEM_GROUP_CHOICES)  # Required
```

```tsx
// Frontend:
<Form.Item
  label="Nh√≥m h·ªá th·ªëng"
  name="system_group"
  rules={[{ required: true, message: 'Vui l√≤ng ch·ªçn nh√≥m h·ªá th·ªëng' }]}
>
  <Select placeholder="Ch·ªçn nh√≥m h·ªá th·ªëng">
    <Option value="national_platform">N·ªÅn t·∫£ng qu·ªëc gia</Option>
    <Option value="ministry_platform">N·ªÅn t·∫£ng d√πng chung c·ªßa B·ªô</Option>
    <Option value="specialized_db">CSDL chuy√™n ng√†nh</Option>
    <Option value="business_app">·ª®ng d·ª•ng nghi·ªáp v·ª•</Option>
    <Option value="portal">C·ªïng th√¥ng tin</Option>
    <Option value="bi_reporting">BI/B√°o c√°o</Option>
    <Option value="esb_integration">ESB/T√≠ch h·ª£p</Option>
    <Option value="other">Kh√°c</Option>
  </Select>
</Form.Item>
```

**Decision:**
- ‚úÖ Make required
- ‚úÖ Replace options with 8 new choices
- ‚úÖ Update database choices

---

#### 1.8. MODIFY: M·ª©c ƒë·ªô Quan tr·ªçng

**Customer Feedback:**
> "M·ª©c ƒë·ªô Quan tr·ªçng: Quan tr·ªçng / Trung b√¨nh / Th·∫•p"

**Analysis:**
- Current: C·ª±c k·ª≥ quan tr·ªçng / Quan tr·ªçng / Trung b√¨nh / Th·∫•p (4 levels)
- New: Quan tr·ªçng / Trung b√¨nh / Th·∫•p (3 levels)
- ‚ö†Ô∏è **Question for customer:** B·ªè "C·ª±c k·ª≥ quan tr·ªçng" hay gh√©p v√†o "Quan tr·ªçng"? --> Reframe v√†o "Quan tr·ªçng"

**Proposed Implementation:**
```python
# Option 1: B·ªè "C·ª±c k·ª≥ quan tr·ªçng"
IMPORTANCE_CHOICES = [
    ('high', 'Quan tr·ªçng'),
    ('medium', 'Trung b√¨nh'),
    ('low', 'Th·∫•p'),
]

# Option 2: Rename "C·ª±c k·ª≥ quan tr·ªçng" -> "Quan tr·ªçng"
IMPORTANCE_CHOICES = [
    ('critical', 'Quan tr·ªçng'),  # Was "C·ª±c k·ª≥ quan tr·ªçng"
    ('medium', 'Trung b√¨nh'),
    ('low', 'Th·∫•p'),
]
```

**Decision:**
- ‚è∏Ô∏è **PENDING CUSTOMER CLARIFICATION:**
  - B·ªè ho√†n to√†n "C·ª±c k·ª≥ quan tr·ªçng"?
  - Hay rename th√†nh "Quan tr·ªçng"?
  - Data migration: H·ªá th·ªëng c≈© c√≥ "C·ª±c k·ª≥ quan tr·ªçng" s·∫Ω chuy·ªÉn th√†nh g√¨?

---

#### 1.9. MODIFY: Ng√†y v·∫≠n h√†nh ‚Üí Ch·ªâ Th√°ng/NƒÉm

**Customer Feedback:**
> "Ng√†y v·∫≠n h√†nh: Ch·ªâ ch·ªçn th√°ng/nƒÉm b·ªè Ng√†y."

**Implementation:**
```python
# Backend: No change to database (still store as DATE)
# But only accept month/year from frontend (set day=01)

# apps/systems/serializers.py
class SystemSerializer(serializers.ModelSerializer):
    operational_date = serializers.DateField(format='%Y-%m', input_formats=['%Y-%m', '%Y-%m-%d'])

    def to_representation(self, instance):
        data = super().to_representation(instance)
        if instance.operational_date:
            data['operational_date'] = instance.operational_date.strftime('%Y-%m')
        return data
```

```tsx
// Frontend: Use DatePicker with month picker
<Form.Item
  label="Ng√†y v·∫≠n h√†nh"
  name="operational_date"
>
  <DatePicker
    picker="month"  // Month picker only
    format="MM/YYYY"
    placeholder="Ch·ªçn th√°ng/nƒÉm"
  />
</Form.Item>
```

**Decision:**
- ‚úÖ Change UI to month/year picker
- ‚úÖ Store as DATE in database (day=01)
- ‚úÖ Display format: MM/YYYY

---

#### 1.10. ADD: S·ªë l·∫ßn n√¢ng c·∫•p

**Customer Feedback:**
> "Th√™m tr∆∞·ªùng: 'S·ªë l·∫ßn n√¢ng c·∫•p'"

**Implementation:**
```python
# Backend:
class System(models.Model):
    upgrade_count = models.IntegerField(default=0, validators=[MinValueValidator(0)])
```

```tsx
// Frontend:
<Form.Item
  label="S·ªë l·∫ßn n√¢ng c·∫•p"
  name="upgrade_count"
  initialValue={0}
>
  <InputNumber min={0} placeholder="VD: 5" />
</Form.Item>
```

**Decision:**
- ‚úÖ Add integer field
- ‚úÖ Default: 0
- ‚úÖ Min: 0

---

#### 1.11. ADD: Th·ªùi gian n√¢ng c·∫•p g·∫ßn nh·∫•t

**Customer Feedback:**
> "Th·ªùi gian n√¢ng c·∫•p g·∫ßn nh·∫•t"

**Implementation:**
```python
# Backend:
class System(models.Model):
    last_upgrade_date = models.DateField(blank=True, null=True)
```

```tsx
// Frontend:
<Form.Item
  label="Th·ªùi gian n√¢ng c·∫•p g·∫ßn nh·∫•t"
  name="last_upgrade_date"
  tooltip="T√πy ch·ªçn - n·∫øu h·ªá th·ªëng ƒë√£ t·ª´ng n√¢ng c·∫•p"
>
  <DatePicker
    picker="month"
    format="MM/YYYY"
    placeholder="Ch·ªçn th√°ng/nƒÉm"
  />
</Form.Item>
```

**Decision:**
- ‚úÖ Add date field (optional)
- ‚úÖ Month/year picker
- ‚úÖ Can be null if never upgraded

---

#### 1.12. REMOVE: C·∫•p ƒë·ªô form

**Customer Feedback:**
> "C·∫•p ƒë·ªô form: B·ªè tr∆∞·ªùng n√†y"

**Decision:**
- ‚úÖ Remove completely (if exists)
- ‚ö†Ô∏è **Check:** Tr∆∞·ªùng n√†y c√≥ t·ªìn t·∫°i trong database hi·ªán t·∫°i kh√¥ng?

---

#### 1.13. REMOVE: Ch·ªß s·ªü h·ªØu nghi·ªáp v·ª• / Ch·ªß s·ªü h·ªØu k·ªπ thu·∫≠t

**Customer Feedback:**
> "B·ªè c√°c tr∆∞·ªùng: Ch·ªß s·ªü h·ªØu nghi·ªáp v·ª• / Ch·ªß s·ªü h·ªØu k·ªπ thu·∫≠t"

**Decision:**
- ‚úÖ Remove from form
- ‚ö†Ô∏è **Database:** Gi·ªØ l·∫°i trong database (nullable) cho data history?
- ‚ö†Ô∏è Ho·∫∑c drop columns trong migration?

**Recommendation:** Gi·ªØ l·∫°i columns nh∆∞ng b·ªè kh·ªèi form (backward compatibility): ƒê·ªìng √Ω

---

### SECTION 2: M·ª•c ti√™u ‚Äì ph·∫°m vi ‚Äì ng∆∞·ªùi d√πng (Business & Users)

**Customer Feedback:**
> "M·ª•c ti√™u ‚Äì ph·∫°m vi ‚Äì ng∆∞·ªùi d√πng (Business & Users) ‚Äî> Em b·ªï sung ph·∫ßn n√†y a th·∫•y thi·∫øu"

**Analysis:**
- üÜï **New Section:** Ho√†n to√†n m·ªõi, c·∫ßn design from scratch
- **Fields:** 11 new fields (mix of text, checkboxes, numbers)

#### 2.1. ADD: M·ª•c ti√™u nghi·ªáp v·ª• (t·ªëi ƒëa 5 g·∫°ch ƒë·∫ßu d√≤ng)

**Implementation:**
```python
# Backend:
class System(models.Model):
    business_objectives = models.JSONField(default=list, blank=True)
    # Store as array: ["Objective 1", "Objective 2", ...]
```

```tsx
// Frontend: Dynamic list with max 5 items
const BusinessObjectivesInput = () => {
  return (
    <Form.List name="business_objectives">
      {(fields, { add, remove }) => (
        <>
          {fields.map((field, index) => (
            <Form.Item
              key={field.key}
              label={index === 0 ? 'M·ª•c ti√™u nghi·ªáp v·ª•' : ''}
              required={false}
            >
              <Input
                placeholder={`M·ª•c ti√™u ${index + 1}`}
                addonAfter={
                  fields.length > 1 ? (
                    <MinusCircleOutlined onClick={() => remove(field.name)} />
                  ) : null
                }
              />
            </Form.Item>
          ))}
          {fields.length < 5 && (
            <Button type="dashed" onClick={() => add()} icon={<PlusOutlined />}>
              Th√™m m·ª•c ti√™u (t·ªëi ƒëa 5)
            </Button>
          )}
        </>
      )}
    </Form.List>
  );
};
```

**Decision:**
- ‚úÖ Store as JSON array
- ‚úÖ Max 5 items
- ‚úÖ Dynamic add/remove

---

#### 2.2. ADD: Quy tr√¨nh nghi·ªáp v·ª• ch√≠nh m√† h·ªá th·ªëng h·ªó tr·ª£ (li·ªát k√™)

**Implementation:**
```python
# Backend:
class System(models.Model):
    business_processes = models.JSONField(default=list, blank=True)
    # Store as array: ["Process 1", "Process 2", ...]
```

```tsx
// Frontend: Similar to business objectives (dynamic list, no max limit)
```

**Decision:**
- ‚úÖ Store as JSON array
- ‚úÖ No max limit
- ‚úÖ Dynamic add/remove

---

#### 2.3. ADD: C√≥ ƒë·ªß h·ªì s∆° ph√¢n t√≠ch thi·∫øt k·∫ø h·ªá th·ªëng? (C√≥/Kh√¥ng)

**Implementation:**
```python
# Backend:
class System(models.Model):
    has_design_documents = models.BooleanField(default=False)
```

```tsx
// Frontend:
<Form.Item
  label="C√≥ ƒë·ªß h·ªì s∆° ph√¢n t√≠ch thi·∫øt k·∫ø h·ªá th·ªëng?"
  name="has_design_documents"
  valuePropName="checked"
>
  <Switch checkedChildren="C√≥" unCheckedChildren="Kh√¥ng" />
</Form.Item>
```

**Decision:**
- ‚úÖ Boolean field
- ‚úÖ Default: False

---

#### 2.4. ADD: ƒê·ªëi t∆∞·ª£ng s·ª≠ d·ª•ng (checkboxes)

**Customer Feedback:**
> "ƒê·ªëi t∆∞·ª£ng s·ª≠ d·ª•ng (N·ªôi b·ªô: vai tr√≤ (l√£nh ƒë·∫°o/c√°n b·ªô x·ª≠ l√Ω/ki·ªÉm duy·ªát‚Ä¶) / B√™n ngo√†i: DN/ng∆∞·ªùi d√¢n/ƒë·ªãa ph∆∞∆°ng/ƒë∆°n v·ªã kh√°c‚Ä¶) ‚Äî> ƒêo·∫°n n√†y cho t√≠ch v√¨ c√≥ th·ªÉ nhi·ªÅu ƒë·ªëi t∆∞·ª£ng s·ª≠ d·ª•ng"

**Implementation:**
```python
# Backend:
USER_TYPE_CHOICES = [
    # Internal
    ('internal_leadership', 'N·ªôi b·ªô - L√£nh ƒë·∫°o'),
    ('internal_staff', 'N·ªôi b·ªô - C√°n b·ªô x·ª≠ l√Ω'),
    ('internal_reviewer', 'N·ªôi b·ªô - Ki·ªÉm duy·ªát'),
    ('internal_other', 'N·ªôi b·ªô - Kh√°c'),
    # External
    ('external_business', 'B√™n ngo√†i - Doanh nghi·ªáp'),
    ('external_citizen', 'B√™n ngo√†i - Ng∆∞·ªùi d√¢n'),
    ('external_local', 'B√™n ngo√†i - ƒê·ªãa ph∆∞∆°ng'),
    ('external_agency', 'B√™n ngo√†i - ƒê∆°n v·ªã kh√°c'),
]

class System(models.Model):
    user_types = models.JSONField(default=list, blank=True)
    # Store as array: ["internal_leadership", "external_citizen", ...]
```

```tsx
// Frontend:
<Form.Item
  label="ƒê·ªëi t∆∞·ª£ng s·ª≠ d·ª•ng"
  name="user_types"
>
  <Checkbox.Group>
    <div>
      <strong>N·ªôi b·ªô:</strong>
      <Checkbox value="internal_leadership">L√£nh ƒë·∫°o</Checkbox>
      <Checkbox value="internal_staff">C√°n b·ªô x·ª≠ l√Ω</Checkbox>
      <Checkbox value="internal_reviewer">Ki·ªÉm duy·ªát</Checkbox>
      <Checkbox value="internal_other">Kh√°c</Checkbox>
    </div>
    <div style={{ marginTop: 8 }}>
      <strong>B√™n ngo√†i:</strong>
      <Checkbox value="external_business">Doanh nghi·ªáp</Checkbox>
      <Checkbox value="external_citizen">Ng∆∞·ªùi d√¢n</Checkbox>
      <Checkbox value="external_local">ƒê·ªãa ph∆∞∆°ng</Checkbox>
      <Checkbox value="external_agency">ƒê∆°n v·ªã kh√°c</Checkbox>
    </div>
  </Checkbox.Group>
</Form.Item>
```

**Decision:**
- ‚úÖ Store as JSON array (multiple selection)
- ‚úÖ 8 predefined options
- ‚úÖ Group by internal/external

---

#### 2.5. ADD: Quy m√¥ ng∆∞·ªùi d√πng (4 s·ªë li·ªáu)

**Customer Feedback:**
> "Quy m√¥ ng∆∞·ªùi d√πng (ƒë·ªãnh l∆∞·ª£ng):
> - T·ªïng s·ªë t√†i kho·∫£n:
> - Ng∆∞·ªùi d√πng ho·∫°t ƒë·ªông th√°ng (MAU)
> - Ng∆∞·ªùi d√πng ho·∫°t ƒë·ªông ng√†y (DAU):
> - S·ªë ƒë∆°n v·ªã/ƒë·ªãa ph∆∞∆°ng: (N·∫øu c√≥) ‚Üí Tr∆∞·ªùng n√†y kh√¥ng b·∫Øt bu·ªôc"

**Implementation:**
```python
# Backend:
class System(models.Model):
    total_accounts = models.IntegerField(blank=True, null=True, validators=[MinValueValidator(0)])
    mau = models.IntegerField(blank=True, null=True, validators=[MinValueValidator(0)])  # Monthly Active Users
    dau = models.IntegerField(blank=True, null=True, validators=[MinValueValidator(0)])  # Daily Active Users
    organization_count = models.IntegerField(blank=True, null=True, validators=[MinValueValidator(0)])  # Optional
```

```tsx
// Frontend:
<Form.Item label="Quy m√¥ ng∆∞·ªùi d√πng">
  <Row gutter={16}>
    <Col span={12}>
      <Form.Item
        name="total_accounts"
        label="T·ªïng s·ªë t√†i kho·∫£n"
        tooltip="T·ªïng s·ªë user account trong h·ªá th·ªëng"
      >
        <InputNumber min={0} placeholder="VD: 1000" style={{ width: '100%' }} />
      </Form.Item>
    </Col>
    <Col span={12}>
      <Form.Item
        name="mau"
        label="Ng∆∞·ªùi d√πng ho·∫°t ƒë·ªông/th√°ng (MAU)"
        tooltip="Monthly Active Users"
      >
        <InputNumber min={0} placeholder="VD: 500" style={{ width: '100%' }} />
      </Form.Item>
    </Col>
  </Row>
  <Row gutter={16}>
    <Col span={12}>
      <Form.Item
        name="dau"
        label="Ng∆∞·ªùi d√πng ho·∫°t ƒë·ªông/ng√†y (DAU)"
        tooltip="Daily Active Users"
      >
        <InputNumber min={0} placeholder="VD: 100" style={{ width: '100%' }} />
      </Form.Item>
    </Col>
    <Col span={12}>
      <Form.Item
        name="organization_count"
        label="S·ªë ƒë∆°n v·ªã/ƒë·ªãa ph∆∞∆°ng (n·∫øu c√≥)"
        tooltip="T√πy ch·ªçn - n·∫øu h·ªá th·ªëng ph·ª•c v·ª• nhi·ªÅu ƒë∆°n v·ªã"
      >
        <InputNumber min={0} placeholder="VD: 63" style={{ width: '100%' }} />
      </Form.Item>
    </Col>
  </Row>
</Form.Item>
```

**Decision:**
- ‚úÖ 4 separate integer fields (all optional)
- ‚úÖ Group in one visual section
- ‚úÖ Add tooltips for clarity

---

### SECTION 3: Ki·∫øn tr√∫c ·ª©ng d·ª•ng (Application Architecture)

**Customer Questions:**
1. "Lo·∫°i ki·∫øn tr√∫c: C√≥ thi·∫øu **Serverless** v√† **SaaS** kh√¥ng?"
2. "Li·ªáu c√≥ th·ªÉ nhi·ªÅu h∆°n ki·∫øn tr√∫c ƒë·ªìng th·ªùi ko ƒë·ªÉ cho t√≠ch ch·ªçn?"

#### 3.1. MODIFY: Lo·∫°i ki·∫øn tr√∫c + Add Serverless/SaaS

**Implementation:**
```python
# Backend:
ARCHITECTURE_CHOICES = [
    ('monolithic', 'Monolithic'),
    ('microservices', 'Microservices'),
    ('soa', 'SOA'),
    ('serverless', 'Serverless'),  # NEW
    ('saas', 'SaaS'),  # NEW
    ('hybrid', 'Hybrid'),
]

class System(models.Model):
    architecture_types = models.JSONField(default=list, blank=True)
    # Allow multiple selections: ["microservices", "serverless"]
```

```tsx
// Frontend: Checkbox.Group for multiple selection
<Form.Item
  label="Lo·∫°i ki·∫øn tr√∫c"
  name="architecture_types"
  tooltip="C√≥ th·ªÉ ch·ªçn nhi·ªÅu ki·∫øn tr√∫c n·∫øu h·ªá th·ªëng hybrid"
>
  <Checkbox.Group>
    <Checkbox value="monolithic">Monolithic</Checkbox>
    <Checkbox value="microservices">Microservices</Checkbox>
    <Checkbox value="soa">SOA</Checkbox>
    <Checkbox value="serverless">Serverless</Checkbox>
    <Checkbox value="saas">SaaS</Checkbox>
    <Checkbox value="hybrid">Hybrid</Checkbox>
  </Checkbox.Group>
</Form.Item>
```

**Decision:**
- ‚úÖ Add Serverless, SaaS
- ‚úÖ Allow multiple selections (checkbox group)
- ‚úÖ Store as JSON array

---

#### 3.2. ADD: C√≥ ph√¢n l·ªõp kh√¥ng? (Presentation/Business/Data/Integration)

**Implementation:**
```python
# Backend:
class System(models.Model):
    has_layered_architecture = models.BooleanField(default=False)
    layers = models.JSONField(default=list, blank=True)
    # If has_layered_architecture=True, store: ["presentation", "business", "data", "integration"]
```

```tsx
// Frontend:
<Form.Item
  label="C√≥ ph√¢n l·ªõp kh√¥ng?"
  name="has_layered_architecture"
  valuePropName="checked"
>
  <Switch onChange={(checked) => setHasLayers(checked)} />
</Form.Item>

{hasLayers && (
  <Form.Item
    label="C√°c l·ªõp"
    name="layers"
  >
    <Checkbox.Group>
      <Checkbox value="presentation">Presentation Layer</Checkbox>
      <Checkbox value="business">Business Layer</Checkbox>
      <Checkbox value="data">Data Layer</Checkbox>
      <Checkbox value="integration">Integration Layer</Checkbox>
    </Checkbox.Group>
  </Form.Item>
)}
```

**Decision:**
- ‚úÖ Boolean + JSON array
- ‚úÖ Conditional display

---

#### 3.3. ADD: Multi-tenant (C√≥/Kh√¥ng)

**Implementation:**
```python
# Backend:
class System(models.Model):
    is_multi_tenant = models.BooleanField(default=False)
```

```tsx
// Frontend:
<Form.Item
  label="C√≥ multi-tenant kh√¥ng?"
  name="is_multi_tenant"
  valuePropName="checked"
>
  <Switch checkedChildren="C√≥" unCheckedChildren="Kh√¥ng" />
</Form.Item>
```

---

#### 3.4. MODIFY: Container h√≥a (Docker/Kubernetes/OpenShift/Kh√°c)

**Implementation:**
```python
# Backend:
class System(models.Model):
    is_containerized = models.BooleanField(default=False)
    container_platforms = models.JSONField(default=list, blank=True)
    # ["docker", "kubernetes", "openshift"]
```

```tsx
// Frontend:
<Form.Item
  label="C√≥ container h√≥a kh√¥ng?"
  name="is_containerized"
  valuePropName="checked"
>
  <Switch onChange={(checked) => setIsContainerized(checked)} />
</Form.Item>

{isContainerized && (
  <Form.Item label="Platform" name="container_platforms">
    <Checkbox.Group>
      <Checkbox value="docker">Docker</Checkbox>
      <Checkbox value="kubernetes">Kubernetes</Checkbox>
      <Checkbox value="openshift">OpenShift</Checkbox>
      <Checkbox value="other">Kh√°c</Checkbox>
    </Checkbox.Group>
  </Form.Item>
)}
```

---

#### 3.5. ADD: C√¥ng ngh·ªá chi ti·∫øt (10+ fields)

**Customer Requirements:**
```
‚Ä¢ Frontend: framework + version
‚Ä¢ Backend: ng√¥n ng·ªØ + framework + version
‚Ä¢ API style: REST/GraphQL/gRPC/SOAP/Kh√°c
‚Ä¢ Messaging/Queue: Kafka/RabbitMQ/ActiveMQ/None
‚Ä¢ Cache: Redis/Memcached/None
‚Ä¢ Search: Elasticsearch/Solr/None
‚Ä¢ Reporting/BI: PowerBI/Tableau/Metabase/Superset/Custom/None
‚Ä¢ Authentication: LDAP/AD/SSO/OIDC/SAML/Local account
```

**Implementation:**
```python
# Backend: Create a separate TechStack model (one-to-one with System)
class SystemTechStack(models.Model):
    system = models.OneToOneField(System, on_delete=models.CASCADE, related_name='tech_stack')

    # Frontend
    frontend_framework = models.CharField(max_length=100, blank=True)
    frontend_version = models.CharField(max_length=50, blank=True)

    # Backend
    backend_language = models.CharField(max_length=100, blank=True)
    backend_framework = models.CharField(max_length=100, blank=True)
    backend_version = models.CharField(max_length=50, blank=True)

    # API
    api_styles = models.JSONField(default=list, blank=True)  # ["REST", "GraphQL"]

    # Messaging
    messaging_queue = models.CharField(max_length=100, blank=True)  # "Kafka", "RabbitMQ", "None"

    # Cache
    cache_system = models.CharField(max_length=100, blank=True)  # "Redis", "Memcached", "None"

    # Search
    search_engine = models.CharField(max_length=100, blank=True)  # "Elasticsearch", "Solr", "None"

    # BI/Reporting
    bi_tool = models.CharField(max_length=100, blank=True)  # "PowerBI", "Tableau", etc.

    # Authentication
    auth_methods = models.JSONField(default=list, blank=True)  # ["LDAP", "SSO"]
```

```tsx
// Frontend: Group in a collapsible section
<Panel header="C√¥ng ngh·ªá chi ti·∫øt" key="tech_stack">
  <Row gutter={16}>
    <Col span={12}>
      <Form.Item label="Frontend Framework" name={['tech_stack', 'frontend_framework']}>
        <Input placeholder="VD: React" />
      </Form.Item>
    </Col>
    <Col span={12}>
      <Form.Item label="Version" name={['tech_stack', 'frontend_version']}>
        <Input placeholder="VD: 18" />
      </Form.Item>
    </Col>
  </Row>
  {/* Similar for other fields */}
</Panel>
```

**Decision:**
- ‚úÖ Separate model `SystemTechStack` (one-to-one)
- ‚úÖ 15+ new fields
- ‚úÖ Group in collapsible panel

---

#### 3.6. ADD: M√£ ngu·ªìn & CI/CD (5 fields)

```python
# Backend:
class SystemTechStack(models.Model):
    # ... existing fields ...

    # Source Code
    source_repository = models.CharField(max_length=100, blank=True)  # "GitLab", "GitHub", etc.
    branching_model = models.CharField(max_length=100, blank=True)

    # CI/CD
    has_cicd = models.BooleanField(default=False)
    cicd_tools = models.JSONField(default=list, blank=True)  # ["Jenkins", "GitLab CI"]

    # Testing
    has_automated_testing = models.BooleanField(default=False)
    testing_tools = models.CharField(max_length=200, blank=True)
```

---

### SECTION 4: CSDL & M√¥ h√¨nh d·ªØ li·ªáu (Data Architecture)

**Customer Requirements:** 15+ new fields about database, data scale, data model

**Implementation Strategy:**
- Create `SystemDataArchitecture` model (one-to-one with System)
- Fields: db_type, db_version, db_size_gb, file_storage_gb, growth_rate, record_count, retention_period, has_erd, master_data, has_sensitive_data, etc.

---

### SECTION 5: T√≠ch h·ª£p ‚Äì li√™n th√¥ng (Integration)

**Customer Question:**
> "Em xem c√°i c·ªßa em ƒë√£ ƒë·ªß ch∆∞a? A th·∫•y c√≥ h∆°i √≠t ko?"

**Analysis:**
- Current integration section may be insufficient
- Need: Integration inventory (list of integrations), API inventory

**Proposed:**
- Create `SystemIntegration` model (many-to-many with System)
- Fields: target_system, data_exchanged, integration_method, frequency, has_api_doc
- Add API inventory fields: total_apis_provided, total_apis_consumed, has_api_gateway

---

### SECTION 6: V·∫≠n h√†nh

**Customer Requirements:**
```
‚Ä¢ N∆°i ƒë·∫∑t: DC B·ªô / Thu√™ ngo√†i / Cloud (AWS/Azure/GCP/VC) / Hybrid
‚Ä¢ Compute: s·ªë VM / c·∫•u h√¨nh CPU/RAM; OS
```

**Implementation:**
```python
# Backend:
class SystemInfrastructure(models.Model):
    system = models.OneToOneField(System, on_delete=models.CASCADE, related_name='infrastructure')

    # Hosting
    hosting_location = models.CharField(max_length=50, choices=[
        ('ministry_dc', 'DC B·ªô'),
        ('outsourced', 'Thu√™ ngo√†i'),
        ('cloud_aws', 'Cloud - AWS'),
        ('cloud_azure', 'Cloud - Azure'),
        ('cloud_gcp', 'Cloud - GCP'),
        ('cloud_vc', 'Cloud - VC'),
        ('hybrid', 'Hybrid'),
    ], blank=True)

    # Compute
    vm_count = models.IntegerField(blank=True, null=True)
    cpu_cores = models.IntegerField(blank=True, null=True)
    ram_gb = models.IntegerField(blank=True, null=True)
    operating_system = models.CharField(max_length=100, blank=True)
```

---

### SECTION 7: ATTT (Security)

**Customer Requirements:**
```
‚Ä¢ Ph√¢n lo·∫°i h·ªá th·ªëng theo c·∫•p ƒë·ªô (n·∫øu ƒë√£ ph√™ duy·ªát): C·∫•p 1‚Äì5?
‚Ä¢ ƒê√£ c√≥ h·ªì s∆° ATTT ch∆∞a? C√≥ / Kh√¥ng
```

**Implementation:**
```python
# Backend:
class System(models.Model):
    # ... existing fields ...
    security_level = models.IntegerField(
        blank=True,
        null=True,
        choices=[(i, f'C·∫•p {i}') for i in range(1, 6)],
        validators=[MinValueValidator(1), MaxValueValidator(5)]
    )
    has_security_documents = models.BooleanField(default=False)
```

---

### SECTION 8: ƒê√°nh gi√° - M·ª©c n·ª£ k·ªπ thu·∫≠t

**Customer Question:**
> "A ƒëang ko hi·ªÉu?"

**Explanation for Customer:**
"M·ª©c n·ª£ k·ªπ thu·∫≠t" (Technical Debt) l√† ƒë√°nh gi√° m·ª©c ƒë·ªô ph√π h·ª£p c·ªßa h·ªá th·ªëng v·ªõi ki·∫øn tr√∫c chung:
- **ƒêi·ªÉm m·∫°nh:** D·ªÖ t√≠ch h·ª£p, c√≥ API t·ªët, d·ªØ li·ªáu s·∫°ch
- **ƒêi·ªÉm y·∫øu:** C√¥ng ngh·ªá c≈©, thi·∫øu t√†i li·ªáu, ph·ª• thu·ªôc nh√† th·∫ßu
- **ƒê·ªÅ xu·∫•t:** Gi·ªØ nguy√™n / N√¢ng c·∫•p / Thay th·∫ø / H·ª£p nh·∫•t

**Implementation:**
```python
# Backend:
class SystemAssessment(models.Model):
    system = models.OneToOneField(System, on_delete=models.CASCADE, related_name='assessment')

    # Strengths
    strengths = models.JSONField(default=list, blank=True)
    # ["easy_to_standardize", "good_api", "clean_data", "can_decompose"]

    # Weaknesses
    weaknesses = models.JSONField(default=list, blank=True)
    # ["outdated_tech", "no_documentation", "no_api", "dirty_data", "vendor_lock"]

    # Recommendation
    recommendation = models.CharField(max_length=50, choices=[
        ('keep', 'Gi·ªØ nguy√™n'),
        ('upgrade', 'N√¢ng c·∫•p'),
        ('replace', 'Thay th·∫ø'),
        ('consolidate', 'H·ª£p nh·∫•t v√†o n·ªÅn t·∫£ng chung'),
    ], blank=True)
```

---

## üìä Implementation Effort Estimation

### Backend (12-15 hours)
| Task | Effort |
|------|--------|
| Create new models (TechStack, DataArchitecture, Infrastructure, Assessment) | 4h |
| Add 44+ new fields to existing System model | 2h |
| Create migrations | 1h |
| Update serializers | 2h |
| Update viewsets & permissions | 2h |
| Add validation logic | 1h |
| Testing (unit + API tests) | 3h |

### Frontend (8-10 hours)
| Task | Effort |
|------|--------|
| Redesign SystemForm component (8 sections) | 3h |
| Create new sub-components (dynamic lists, checkbox groups) | 2h |
| Update form validation | 1h |
| Update SystemTable to display new fields | 1h |
| Update SystemDetail view | 1h |
| Testing (browser testing) | 2h |

### Data Migration (1-2 hours)
| Task | Effort |
|------|--------|
| Write migration scripts for existing systems | 1h |
| Test migration on staging | 0.5h |
| Execute on production | 0.5h |

### Documentation (2 hours)
| Task | Effort |
|------|--------|
| Update API docs | 1h |
| Update user guide | 0.5h |
| Update admin guide | 0.5h |

**Total: 23-29 hours** (~3-4 working days)

---

## üéØ Implementation Phases

### Phase 1: Customer Review & Approval (CURRENT)
- ‚úÖ Save customer feedback
- ‚è≥ Create this implementation plan
- ‚è≥ Customer review plan
- ‚è≥ Customer approval & clarifications

**Pending Clarifications:**
1. M·ª©c ƒë·ªô Quan tr·ªçng: B·ªè "C·ª±c k·ª≥ quan tr·ªçng" hay rename?
2. Section 5 (Integration): Customer confirm "ƒë√£ ƒë·ªß" hay c·∫ßn b·ªï sung g√¨?
3. Confirm all new fields are needed (44 fields is a LOT!)

### Phase 2: Backend Implementation (Day 1-2)
- [ ] Create database migrations
- [ ] Add new models
- [ ] Update existing models
- [ ] Create serializers
- [ ] Update API endpoints
- [ ] Add validation
- [ ] Write tests

### Phase 3: Frontend Implementation (Day 2-3)
- [ ] Redesign SystemForm
- [ ] Create sub-components
- [ ] Update validation
- [ ] Update table & detail views
- [ ] Browser testing

### Phase 4: Data Migration & Testing (Day 3)
- [ ] Migrate existing systems
- [ ] End-to-end testing
- [ ] UAT with customer
- [ ] Bug fixes

### Phase 5: Deployment (Day 4)
- [ ] Deploy to production
- [ ] Smoke testing
- [ ] Monitor for issues
- [ ] Update documentation

---

## ‚ö†Ô∏è Risks & Mitigation

### Risk 1: Scope Creep
**Risk:** 44+ new fields is massive, may delay delivery
**Mitigation:** Phased rollout - implement core fields first, optional fields later

### Risk 2: Data Migration Issues
**Risk:** Existing systems may not have data for new required fields
**Mitigation:** Make new fields optional, allow gradual data completion

### Risk 3: UX Complexity
**Risk:** Form too long, overwhelming for users
**Mitigation:** Use tabs, collapsible sections, progressive disclosure

### Risk 4: Performance
**Risk:** 4 new related models may slow down queries
**Mitigation:** Use select_related, prefetch_related, database indexing

---

## üìù Questions for Customer (URGENT)

Before implementation, please clarify:

1. **M·ª©c ƒë·ªô Quan tr·ªçng:**
   - [ ] B·ªè ho√†n to√†n "C·ª±c k·ª≥ quan tr·ªçng"?
   - [x] Rename "C·ª±c k·ª≥ quan tr·ªçng" ‚Üí "Quan tr·ªçng"?
   - [ ] H·ªá th·ªëng c≈© c√≥ "C·ª±c k·ª≥ quan tr·ªçng" s·∫Ω migrate th√†nh g√¨? --> "Quan tr·ªçng"

2. **Section 5 - Integration:**
   - [ ] Ph·∫ßn t√≠ch h·ª£p hi·ªán t·∫°i ƒë√£ ƒë·ªß?
   - [x] Hay c·∫ßn th√™m nh∆∞ customer suggestion?

3. **Required vs Optional:**
   - [ ] Tr∆∞·ªùng n√†o B·∫ÆT BU·ªòC ph·∫£i nh·∫≠p? --> Nh·ªØng tr∆∞·ªùng m√† customer feedback l√† b·∫Øt bu·ªôc
   - [ ] Tr∆∞·ªùng n√†o optional?
   - [ ] C√≥ th·ªÉ ƒë·ªÉ user ƒëi·ªÅn d·∫ßn sau kh√¥ng?

4. **Phased Rollout:**
   - [x] Implement t·∫•t c·∫£ 44 fields ngay?
   - [ ] Hay chia l√†m 2 phases (core + extended)?

5. **Existing Data:**
   - [x] H·ªá th·ªëng c≈© kh√¥ng c√≥ data cho tr∆∞·ªùng m·ªõi ‚Üí ƒë·ªÉ tr·ªëng ƒë∆∞·ª£c kh√¥ng? --> ok ƒë·ªÉ tr·ªëng v·ªõi data c≈©
   - [ ] Hay ph·∫£i b·∫Øt user c·∫≠p nh·∫≠t ƒë·∫ßy ƒë·ªß?

---

## ‚úÖ Next Steps

1. **Customer Review** (This document)
   - [ ] Customer ƒë·ªçc k·ªπ implementation plan
   - [ ] Answer questions above
   - [ ] Approve to proceed

2. **Detailed Design** (After approval)
   - [ ] Finalize database schema
   - [ ] Create wireframes for new form
   - [ ] Customer review UI mockups

3. **Implementation** (After design approval)
   - [ ] Backend development (Day 1-2)
   - [ ] Frontend development (Day 2-3)
   - [ ] Testing (Day 3)
   - [ ] Deployment (Day 4)

---

**Status:** ‚è∏Ô∏è PENDING CUSTOMER REVIEW & APPROVAL
**Created:** 2026-01-18
**Author:** Claude Code Agent (Vibe Coding Agent)
**Next Action:** Wait for customer feedback on this plan
